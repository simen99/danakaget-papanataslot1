<!DOCTYPE html>
<html>
<head>
<title>Papanatasslot - Dana Kaget</title>
<link rel="icon" type="image/png" href="https://raw.githubusercontent.com/simen99/danakaget-papanataslot1/refs/heads/main/assets/049b1ca3-db9f-42b9-980d-7363faac5600.png">
<base target="_top">
<meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">
<!-- Fonts -->
<link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@600;800&family=Poppins:wght@400;600&family=Russo+One&display=swap" rel="stylesheet">
<style>
:root{ --gold1:#ffd700; --gold2:#f5c013; --gold3:#b8860b; }
body{ margin:0; background:#111; color:#fff; text-align:center; padding:24px 12px; font-family:'Poppins',sans-serif; }
h1{ font-family:'Orbitron',sans-serif; color:#ffcc00; letter-spacing:.5px; margin:0 0 14px; font-size:30px; }

/* Inputs */
.input-container{
display:flex;
flex-direction:column;    /* urut vertikal */
align-items:center;       /* tengah */
gap:10px;                 /* jarak antar input */
}
.input-gold{
width:240px;
padding:12px 14px 12px 46px; /* space untuk ikon kiri */
border-radius:14px;
border:1px solid #b37b00;
background:
radial-gradient(120% 80% at 30% 0%, rgba(255,255,255,.35) 0%, rgba(255,255,255,0) 60%),
linear-gradient(165deg,#ffe27a 0%, #f1c232 40%, #d8a700 100%);
color:#1a1300;
font-weight:700;
letter-spacing:.2px;
outline:0;
transition:transform .18s ease, box-shadow .2s ease, border-color .2s ease, filter .2s ease;
box-shadow:
inset 0 2px 0 rgba(255,255,255,.45),
inset 0 -3px 8px rgba(0,0,0,.15),
0 6px 16px rgba(179,123,0,.18);
backdrop-filter: saturate(1.1);
}
.input-gold::placeholder{
color: rgba(26,19,0,.8); /* lebih pekat, tetap elegan */
text-transform: uppercase;
letter-spacing: .6px;
font-weight: 800;
text-shadow: 0 1px 0 rgba(255,255,255,.35);
}
.input-gold:hover,.input-gold:focus{
transform: translateY(-1px);
border-color:#ffcf33;
box-shadow:
inset 0 2px 0 rgba(255,255,255,.55),
inset 0 -3px 10px rgba(0,0,0,.18),
0 0 0 3px rgba(255,207,51,.28),
0 10px 22px rgba(255,215,0,.25);
filter: saturate(1.08);
}

/* Ikon kiri tanpa ubah HTML */
#userId{
background:
url("data:image/svg+xml,%3Csvg width='22' height='22' viewBox='0 0 24 24' fill='none' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M12 12a5 5 0 1 0-5-5 5 5 0 0 0 5 5Zm0 2c-4.418 0-8 2.239-8 5v1h16v-1c0-2.761-3.582-5-8-5Z' fill='%231a1300'/%3E%3C/svg%3E") no-repeat 14px 50% / 22px,
radial-gradient(120% 80% at 30% 0%, rgba(255,255,255,.35) 0%, rgba(255,255,255,0) 60%),
linear-gradient(165deg,#ffe27a 0%, #f1c232 40%, #d8a700 100%);
}

#kupon{
background:
url("data:image/svg+xml,%3Csvg width='22' height='22' viewBox='0 0 24 24' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath fill='%231a1300' d='M3 7a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2v2a2 2 0 1 0 0 4v2a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-2a2 2 0 1 0 0-4Zm6 1h2v8H9Zm4 0h2v8h-2Z'/%3E%3C/svg%3E") no-repeat 14px 50% / 22px,
radial-gradient(120% 80% at 30% 0%, rgba(255,255,255,.35) 0%, rgba(255,255,255,0) 60%),
linear-gradient(165deg,#ffe27a 0%, #f1c232 40%, #d8a700 100%);
}
.card.flipped .card-inner{
-webkit-transform: rotateY(180deg);
transform: rotateY(180deg);
}

.front{
background-image: url('https://raw.githubusercontent.com/simen99/danakaget-papanataslot1/d87760746f92ccda0ab741f347d9730a4c94553b/assets/dana-kaget-spesial-weekend.jpg');
background-size:cover; background-position:center;
padding:10px;
}

.back{
-webkit-transform: rotateY(180deg);
transform: rotateY(180deg);
background:linear-gradient(160deg,var(--gold1) 0%,var(--gold2) 50%,var(--gold3) 100%);
color:#111; display:flex; align-items:center; justify-content:center;
}

/* Button */
.btn{
padding:9px 14px; margin-bottom:10px; border:0; border-radius:10px;
background:#ffcc00; color:#111; font-weight:900; cursor:pointer;
transition:transform .15s, box-shadow .2s; animation:pulse 1.5s infinite;
box-shadow:0 4px 0 rgba(0,0,0,.25), 0 0 0 rgba(255,215,0,0);
}
.btn:hover{ transform:translateY(-1px) scale(1.03); box-shadow:0 6px 0 rgba(0,0,0,.28), 0 0 12px rgba(255,215,0,.8); }
.btn:disabled{ opacity:.6; cursor:not-allowed; animation:none; }
@keyframes pulse{
0%{box-shadow:0 4px 0 rgba(0,0,0,.25),0 0 0 rgba(255,215,0,0)}
50%{box-shadow:0 4px 0 rgba(0,0,0,.25),0 0 14px rgba(255,215,0,.9)}
100%{box-shadow:0 4px 0 rgba(0,0,0,.25),0 0 0 rgba(255,215,0,0)}
}

/* Back contents */
.saldo-wrap{ text-align:center; }
.saldo-title{ font-weight:900; letter-spacing:.6px; margin-bottom:6px; }
.saldo-amount{ font-family:'Russo One',sans-serif; font-size:22px; }

.fake-amount{ font-family:'Russo One',sans-serif; font-size:20px; }

.pas-popup { font-family:'Poppins',sans-serif; text-align:center; }
.pas-popup .pas-brand { width:170px; margin:0 auto 8px; }
.pas-popup .pas-subtitle { margin:4px 0 6px; font-weight:800; }
.pas-popup .pas-amount {
color:#e30606; font-weight:900; font-size:36px;
font-family:'Russo One',sans-serif;
}
.pas-popup .pas-meta { font-size:14px; margin:2px 0; font-weight:700; }
.pas-popup .pas-hint {
margin:12px auto; padding:10px 12px; max-width:340px;
border-radius:10px; background:#efefef; font-weight:800;
}

.pas-btn{
display:block;
width:min(100%,340px);
margin:6px auto;
padding:12px;
border:none;
border-radius:12px;
font-weight:900;
color:#fff;
text-decoration:none;
cursor:pointer;
transition:transform .15s ease, filter .2s ease;
}
.pas-btn:hover{ transform:translateY(-1px); filter:brightness(1.05); }
.pas-wa{ background:#16a34a; }
.pas-tg{ background:#1d9bf0; }
.pas-reset{ background:#2563eb; }

/* HP kecil: tombol klaim ditumpuk */
@media (max-width:360px){
.pas-btn-row{ flex-direction:column; }
}

.pas-btn-row{
display:flex;
gap:10px;
justify-content:center;
align-items:center;
max-width:340px;
margin:10px auto 8px;
}

/* override ukuran tombol saat di dalam baris flex */
.pas-btn-row .pas-btn{
flex:1;
width:auto;      /* jangan full width */
margin:0;        /* hilangkan margin auto bawaan */
}

/* === Glow emas per-box saat kursor mengarah === */
.card {
cursor: pointer;
border-radius: 16px; /* samakan dengan sudut box isi */
transition: box-shadow .25s ease, transform .2s ease;
}
.card:hover {
box-shadow:
0 0 12px rgba(255,215,0,.95),
0 0 28px rgba(255,215,0,.60),
0 0 44px rgba(255,215,0,.35);
transform: scale(1.02);
}

/* === Tombol "PILIH BOX" dibungkus garis hitam === */
.btn{
border: 2px solid #000 !important;   /* garis hitam */
box-shadow:
0 4px 0 rgba(0,0,0,.25),
0 0 0 rgba(255,215,0,0);
}
.btn:hover{
border-color:#000;
box-shadow:
0 6px 0 rgba(0,0,0,.28),
0 0 12px rgba(255,215,0,.8);
}
/* aksesibilitas (keyboard focus) */
.btn:focus-visible{
outline: 2px solid #000;
outline-offset: 2px;
}

/* Tombol Mengambang Kiri */
.floating-btn {
position: fixed;
left: 20px;          /* jarak dari kiri */
z-index: 9999;
display: inline-block;
transition: transform 0.25s ease;
}

/* Cincin emas tipis */
.floating-btn img {
width: 60px;
height: 60px;
border-radius: 50%;
padding: 2px; /* tipis seperti cincin */
background: linear-gradient(145deg, #ffd700, #b8860b); /* gradasi emas */
box-shadow:
0 0 6px rgba(255, 215, 0, 0.6),
0 0 12px rgba(255, 215, 0, 0.4);
transition: transform 0.2s ease, box-shadow 0.3s ease;
}

/* Hover lebih glow */
.floating-btn img:hover {
transform: scale(1.06);
box-shadow:
0 0 8px rgba(255, 215, 0, 0.8),
0 0 16px rgba(255, 215, 0, 0.6);
}

/* Efek denyut halus untuk tombol popup hadiah */
.pas-popup .pas-btn {
animation: popupPulse 1.8s infinite ease-in-out;
}

@keyframes popupPulse {
0%   { transform: scale(1); box-shadow: 0 0 0 rgba(0,0,0,0.3); }
50%  { transform: scale(1.05); box-shadow: 0 0 12px rgba(0,0,0,0.2); }
100% { transform: scale(1); box-shadow: 0 0 0 rgba(0,0,0,0.3); }
}

.btn-hide { display: none !important; }

.marquee-box {
display: flex;
align-items: center;
background: linear-gradient(165deg, #ffe27a 0%, #f1c232 40%, #d8a700 100%);
padding: 8px 12px;
border-radius: 12px;
max-width: 680px;
margin: 0 auto 14px;
box-shadow: 0 4px 8px rgba(0,0,0,0.25), inset 0 2px 0 rgba(255,255,255,0.4);
}

.marquee-icon {
font-size: 20px;
font-weight: bold;
margin-right: 8px;
flex-shrink: 0; /* biar ikon tidak mengecil */
}

.marquee-container {
overflow: hidden;
flex: 1;
}

.marquee-text {
display: inline-block;
white-space: nowrap;
animation: marqueeAnim 15s linear infinite;
font-weight: bold;
}

@keyframes marqueeAnim {
0%   { transform: translateX(100%); }
100% { transform: translateX(-100%); }
}

/* Box terpilih: back jadi hijau + glow hijau */
.card.selected-box .back{
background: linear-gradient(160deg, #00c853 0%, #00e676 50%, #1b5e20 100%) !important;
color:#fff !important;
box-shadow: 0 0 16px rgba(0,255,120,.85), 0 0 36px rgba(0,255,120,.45);
transition: background .25s ease, box-shadow .25s ease;
}

/* Override glow kuning saat hover — jangan ganggu yang hijau */
.card.selected-box:hover{
box-shadow: 0 0 0 rgba(0,0,0,0); /* matikan hover kuning bawaan .card */
}

/* Optional: saat sudah flipped, hover kuning dimatikan juga */
.card.flipped:hover{
box-shadow: none;
}

#confetti-canvas {
position: fixed;
top: 0;
left: 0;
width: 100%;
height: 100%;
pointer-events: none; /* biar klik tetap tembus ke bawah */
z-index: 10000; /* lebih tinggi dari popup hadiah */
}

/* getar halus */
@keyframes pasShake {
0%, 100% { transform: translate3d(0,0,0) rotate(0deg); }
5%  { transform: translate3d(1px,-1px,0) rotate(-0.4deg); }
10% { transform: translate3d(-1px,1px,0) rotate(0.4deg); }
15% { transform: translate3d(1px,0,0) rotate(-0.3deg); }
20% { transform: translate3d(-1px,0,0) rotate(0.3deg); }
25% { transform: translate3d(0,1px,0) rotate(-0.2deg); }
30% { transform: translate3d(0,-1px,0) rotate(0.2deg); }
/* sisanya diam sampai akhir biar tidak terlalu ramai */
60%, 99% { transform: translate3d(0,0,0) rotate(0deg); }
}

/* terapkan ke semua box */
.card.shake {
animation: pasShake 4.5s ease-in-out infinite;
animation-delay: var(--shake-delay, 0s); /* tiap box beda delay */
will-change: transform;
}

/* saat di-hover atau sudah dibuka, hentikan getar */
.card:hover,
.card.flipped {
animation: none !important;
}

/* aksesibilitas: matikan kalau user pilih reduce motion */
@media (prefers-reduced-motion: reduce) {
.card.shake { animation: none !important; }
}

/* LINK LOGIN + PLAY BUTTON (gaya sama) */
.login-link,
.login-link:link,
.login-link:visited,
.btn-like-login{
  display:flex;
  justify-content:center;
  align-items:center;

  /* lebar responsif sama persis */
  width: 100%;
  max-width: 320px;
  margin-inline: auto;
  box-sizing: border-box;

  padding:12px 14px;
  border-radius:14px;
  border:1px solid #b37b00 !important;
  background:
    radial-gradient(120% 80% at 30% 0%, rgba(255,255,255,.35) 0%, rgba(255,255,255,0) 60%),
    linear-gradient(165deg,#ffe27a 0%, #f1c232 40%, #d8a700 100%) !important;
  box-shadow:
    inset 0 2px 0 rgba(255,255,255,.45),
    inset 0 -3px 8px rgba(0,0,0,.15),
    0 6px 16px rgba(179,123,0,.18);
  color:#1a1300 !important;
  text-decoration:none !important;
  text-transform:uppercase;
  font-weight:900;
  letter-spacing:.6px;
  text-shadow:0 1px 0 rgba(255,255,255,.35);

  /* override gaya .btn kuning default */
  animation:none !important;
}

/* efek hover/focus sama */
.login-link:hover,
.login-link:focus,
.btn-like-login:hover,
.btn-like-login:focus{
  transform: translateY(-1px);
  border-color:#ffcf33;
  box-shadow:
    inset 0 2px 0 rgba(255,255,255,.55),
    inset 0 -3px 10px rgba(0,0,0,.18),
    0 0 0 3px rgba(255,207,51,.28),
    0 10px 22px rgba(255,215,0,.25);
  outline:0;
}

/* responsif modern: samakan juga untuk tombol play */
@supports (width: min(92vw, 320px)) {
  .login-link,
  .btn-like-login{ width: min(92vw, 320px); }
}

.card.zonk-box .back{
background: linear-gradient(160deg,#ff3b30 0%,#ff6b6b 50%,#b00020 100%) !important;
color:#fff !important;
box-shadow: 0 0 16px rgba(255,59,48,.85), 0 0 36px rgba(255,59,48,.45);
}
.zonk-label{
font-family:'Russo One',sans-serif;
font-size:22px;
text-transform:uppercase;
letter-spacing:.6px;
}

/* === PROMO POPUP 610x310 === */
.promo-overlay{
position:fixed; inset:0; display:none;
align-items:center; justify-content:center;
background:rgba(0,0,0,.82); z-index:10080;
}
.promo-box{
width:610px; height:310px; position:relative; overflow:hidden;
border-radius:12px; box-shadow:0 20px 60px rgba(0,0,0,.55);
background:#000;
}
.promo-box img{ width:100%; height:100%; object-fit:cover; display:block; }

@media (max-width:660px){
.promo-box{ width:min(95vw,610px); height:calc(min(95vw,610px) * 310 / 610); }
}

/* Konten di dalam tetap rapi di atas background emas */
#popup .pas-popup{ margin-top:10px; }

/* Tombol X (emas solid) */
.popup-x{
position:absolute; top:8px; right:10px;
background:transparent !important;
border:none; outline:none;
color:#FFD700 !important;            /* EMAS */
font-weight:900; font-size:24px;
line-height:1; cursor:pointer;
text-shadow:0 1px 2px rgba(0,0,0,.45), 0 0 8px rgba(255,215,0,.45);
transition:transform .15s ease;
}
.popup-x:hover{ transform:scale(1.08); }

/* Override: tombol X di popup promo (tanpa background, lebih besar) */

.promo-close{
position:absolute; top:6px; right:6px;
background:transparent !important;  /* hilangkan lingkaran hitam */
border:none !important;
border-radius:0 !important;
color:#fff !important;              /* X putih */
font-size:30px !important;          /* lebih besar */
line-height:1 !important;
padding:6px 8px !important;         /* area klik nyaman */
width:auto !important; height:auto !important;
text-shadow:0 1px 2px rgba(0,0,0,.45);
cursor:pointer; transition:transform .15s ease;
}
.promo-close:hover{ transform:scale(1.06); }

/* ==== Popup hadiah: ABU-ABU SMOOTH + X putih ==== */
#popup .popup-box{
position: relative;
width: min(92%, 380px);
padding: 22px;
border-radius: 16px;

/* abu-abu halus */
background: linear-gradient(180deg,#f5f6f8 0%, #e8eaef 100%) !important;
border:1px solid rgba(0,0,0,.12) !important;
color:#111 !important;
box-shadow: 0 12px 28px rgba(0,0,0,.28) !important; /* no inset white */
}

/* hint tetap kontras di background abu-abu */
#popup .pas-hint{
background:#fff;
border:1px solid rgba(0,0,0,.08);
}

/* === Border EMAS untuk promo popup === */
.promo-box{
position: relative;
border-radius: 14px;
overflow: hidden;                 /* biar sudut emas rapi */
}

/* cincin emas gradient */
.promo-box::after{
content:"";
position:absolute; inset:0;
border-radius:14px;
padding:4px;                      /* tebal border */
background: linear-gradient(160deg,#ffe27a 0%,#f1c232 45%,#b8860b 100%);
-webkit-mask:
linear-gradient(#000 0 0) content-box,
linear-gradient(#000 0 0);
-webkit-mask-composite: xor;
mask-composite: exclude;  /* lubangi tengahnya */
pointer-events:none;
z-index:2;
}

/* sedikit glow biar makin “emas” */
.promo-box{
box-shadow: 0 12px 34px rgba(0,0,0,.45),
0 0 22px rgba(255,215,0,.35);
}

/* Grid responsif: 3 kolom di layar lebar, 2 kolom di HP, 1 kolom di HP super kecil */
.grid{
display:grid;
gap:20px;
justify-content:center;
margin:6px auto 6px;
grid-template-columns:repeat(3, minmax(160px, 1fr));
max-width:640px;
}

/* HP: paksa 2 kolom */
@media (max-width: 720px){
.grid{
grid-template-columns: repeat(2, minmax(140px, 1fr)) !important;
max-width: 520px !important;   /* opsional biar pas di tengah */
margin-inline: auto;
}
.card{ max-width: none; }        /* biar ikut lebar kolom */
}

/* HP super kecil tetap 2 kolom */
@media (max-width: 380px){
.grid{
grid-template-columns: repeat(2, minmax(140px, 1fr)) !important;
gap: 12px;                      /* rapetin jarak kalau perlu */
}
}

/* Biar sisi belakang (hadiah/zonk) tetap di tengah */
.card .back{
display:flex;
align-items:center !important;
justify-content:center !important;
}

/* Tombol di sisi depan tetap nempel bawah */
.card .front{
display:flex;
align-items:flex-end;
justify-content:center;
}

/* Fix Xiaomi/Redmi: lebar input kebesaran & tidak center */
.input-gold,
.login-link{
width: 100%;
max-width: 320px;
margin-inline: auto;
box-sizing: border-box;
}

/* Browser modern tetap boleh pakai min() */
@supports (width: min(92vw, 320px)) {
.input-gold,
.login-link{
width: min(92vw, 320px);
}
}

.card{
width:100%;
height:auto;          /* gantikan height fixed */
aspect-ratio: 1 / 1;  /* biar kotak */
perspective:1000px;
max-width:300px;
margin-inline:auto;   /* center tiap kartu di kolomnya */
}

/* Fallback kotak untuk browser yang belum support aspect-ratio */
@supports not (aspect-ratio: 1 / 1) {
.card { position: relative; max-width:300px; margin-inline:auto; }
.card::before { content:""; display:block; padding-top:100%; } /* bikin kotak */
.card-inner { position: absolute; inset: 0; }
}

/* Card (flip) */
.card-inner{
position:relative;
width:100%;
height:100%;
-webkit-transform-style: preserve-3d; /* tambahkan */
transform-style: preserve-3d;
transition: transform 1s cubic-bezier(.22,.8,.22,1);
}

.face{
position:absolute;
inset:0;
border-radius:16px;
overflow:hidden;
box-shadow:0 0 10px rgba(255,215,0,.7);
display:flex;
align-items:flex-end;
justify-content:center;
-webkit-backface-visibility: hidden;    /* tambahkan */
backface-visibility: hidden;
}

/* Overlay: gelap + blur, tanpa vignette putih */
.alert-overlay{
position:fixed; inset:0;
display:none;
align-items:center; justify-content:center;
background:rgba(0,0,0,.60);
backdrop-filter: blur(10px);
-webkit-backdrop-filter: blur(10px);
z-index:10090;
opacity:0; transition:opacity .22s ease;
}
.alert-overlay.show{ opacity:1; }

/* Kartu: kaca gelap, sudut lembut, shadow natural (no inner white) */
.alert-box{
position:relative;
width:min(92vw,420px);
padding:22px 18px 16px;
border-radius:16px;

/* lapisan kaca gelap tipis */
background:
linear-gradient(180deg, rgba(255,255,255,.06), rgba(255,255,255,.02)),
rgba(24,24,28,.78);
border:1px solid rgba(255,255,255,.08);

/* bayangan jatuh natural */
box-shadow:
0 12px 30px rgba(0,0,0,.45),
0 2px 6px rgba(0,0,0,.25);

transform: translateY(10px) scale(.98);
opacity:.96;
transition: transform .28s cubic-bezier(.2,.9,.2,1), opacity .28s ease;
}
.alert-overlay.show .alert-box{
transform: translateY(0) scale(1);
opacity:1;
}

/* Matikan semua aksen/strip putih lama */
.alert-box::before,
.alert-box::after{ content:none !important; }

/* Close: minimalis */
.alert-close{
position:absolute; top:10px; right:10px;
width:34px; height:34px; border-radius:10px;
display:grid; place-items:center;
background: rgba(255,255,255,.06);
border:1px solid rgba(255,255,255,.08);
color:#e5e7eb; font-size:18px; line-height:1;
cursor:pointer; transition:transform .12s ease, background .2s ease;
}
.alert-close:hover{ transform:scale(1.06); background:rgba(255,255,255,.10); }

/* Icon: badge bulat dengan glow warna (tanpa ring putih) */
.alert-icon{
width:64px; height:64px; margin:-54px auto 10px;
display:grid; place-items:center;
border-radius:50%;
color:#fff; font-size:28px; font-weight:900;

background: radial-gradient(60% 60% at 30% 30%, rgba(255,255,255,.15), rgba(255,255,255,0)),
var(--accent);
box-shadow:
0 10px 24px color-mix(in srgb, var(--accent) 35%, transparent 65%),
0 0 0 3px rgba(255,255,255,.06) inset;
border:none;
}

/* Teks: kontras di dark glass */
.alert-title{
margin:2px 0 6px;
font-size:18px; font-weight:900;
color:#f3f4f6; letter-spacing:.2px;
}
.alert-msg{
margin:0 6px 12px;
color:#e5e7eb; font-weight:600; line-height:1.45;
}

/* Tombol aksi: kapsul dengan gradient accent + glow tipis */
.alert-actions{ display:flex; justify-content:center; gap:8px; }
.btn-alert{
border:none; cursor:pointer; border-radius:999px;
padding:11px 18px; font-weight:900; color:#0b0f14;

background:
linear-gradient(180deg,
color-mix(in srgb, var(--accent) 85%, #fff 15%),
color-mix(in srgb, var(--accent) 65%, #000 35%)
);
box-shadow:
0 8px 18px color-mix(in srgb, var(--accent) 30%, transparent 70%),
0 1px 0 rgba(255,255,255,.25) inset;
transition: transform .12s ease, filter .2s ease;
}
.btn-alert:hover{ transform:translateY(-1px); filter:brightness(1.06); }

/* Progress bar: tipis elegan */
.alert-progress{ height:4px; border-radius:99px; background:rgba(255,255,255,.08); overflow:hidden; }
.alert-progress .fill{
height:100%; display:block;
background: linear-gradient(90deg,
color-mix(in srgb, var(--accent) 70%, #fff 30%),
var(--accent)
);
animation: alertProgress linear forwards;
transform-origin:left center;
}

/* Tema warna dari data-type */
.alert-overlay[data-type="success"] { --accent:#16a34a; } /* green-600 */
.alert-overlay[data-type="warning"] { --accent:#f59e0b; } /* amber-500 */
.alert-overlay[data-type="error"]   { --accent:#ef4444; } /* red-500 */
.alert-overlay[data-type="info"]    { --accent:#3b82f6; } /* blue-500 */

/* semua tombol: pastikan benar-benar 60x60 dan bulat */
.floating-btn img{
width:60px;
height:60px;         /* sebelumnya auto; bikin pas bulat */
border-radius:50%;
box-shadow:0 4px 12px rgba(0,0,0,.4);
}

/* LIVECHAT — samakan ukuran & glow dengan WA/Tele */
.floating-btn.livechat{
position: fixed;
left: 20px;
bottom: 259px;      /* geser sesuai kebutuhan */
width: 60px;
height: 60px;
display: grid;
place-items: center;
border-radius: 50%;
z-index: 9999;
}

/* pakai ring gradient sama seperti .floating-btn img */
.floating-btn.livechat img{
width: 60px;
height: 60px;
border-radius: 50%;
padding: 2px;  /* cincin tipis */
background: linear-gradient(145deg, #ffd700, #b8860b);
box-shadow:
0 0 6px rgba(255,215,0,.6),
0 0 12px rgba(255,215,0,.4);
transition: transform .2s ease, box-shadow .3s ease;
}

/* glow saat hover (sama dengan WA/Tele) */
.floating-btn.livechat img:hover{
transform: scale(1.06);
box-shadow:
0 0 8px rgba(255,215,0,.8),
0 0 16px rgba(255,215,0,.6);
}

/* matikan ring pseudo-element lama kalau masih ada */
.floating-btn.livechat::after{ display:none; }

.btn{ position:relative; overflow:hidden; }
.btn .ripple{
position:absolute; border-radius:50%;
transform: scale(0); opacity:.6; pointer-events:none;
background:#fff;
animation: btnRipple .6s ease-out forwards;
}
@keyframes btnRipple{ to{ transform:scale(10); opacity:0; } }

/* === SPARKLE GLITTER EMAS === */
.sparkles{ position:absolute; inset:0; pointer-events:none; overflow:hidden; }
.sparkles .sp{
position:absolute; width:6px; height:6px; border-radius:50%;
background:
radial-gradient(circle at 30% 30%, #fff, rgba(255,255,255,0) 60%),
radial-gradient(circle at 70% 70%, #ffd700, rgba(255,215,0,0) 70%);
box-shadow: 0 0 6px rgba(255,215,0,.7);
filter: saturate(1.2);
animation: spTwinkle var(--sp-dur, 2.2s) ease-in-out infinite;
animation-delay: var(--sp-delay, 0s);
opacity:.0;
}
@keyframes spTwinkle{
0%, 100% { transform: scale(.6) rotate(0); opacity:0; }
40%      { transform: scale(1.15) rotate(45deg); opacity:.95; }
60%      { transform: scale(.9) rotate(90deg); opacity:.6; }
}
.card.flipped .sparkles{ display:none; } /* biar nggak ganggu saat hadiah tampil */

/* === BOKEH LATAR === */
#pas-bokeh{
position: fixed; inset:0; pointer-events:none; z-index: 0;
overflow:hidden;
}
.bokeh-dot{
position:absolute; border-radius:50%;
background: radial-gradient(circle, rgba(255,255,255,.7), rgba(255,255,255,0) 70%);
opacity:.12;
animation: bokehFloat var(--bk-dur, 18s) linear infinite;
filter: blur(1px);
}
@keyframes bokehFloat{
0%   { transform: translateY(110vh) translateX(0) scale(var(--bk-scale,1)); }
100% { transform: translateY(-20vh) translateX(var(--bk-dx, 40px)) scale(var(--bk-scale,1)); }
}

/* === GOLD DUST DRIFT (INSIDE) === */
.pas-dust{ position:absolute; inset:0; pointer-events:none; overflow:hidden; }
.pas-dust .d{
position:absolute; border-radius:50%;
background: radial-gradient(circle, rgba(255,255,255,.55), rgba(255,215,0,.0) 65%);
opacity:.10; filter: blur(0.5px);
animation: pasDust 10s linear infinite;
}
@keyframes pasDust{
0%   { transform: translateY(20%); opacity:.00; }
10%  { opacity:.12; }
80%  { opacity:.12; }
100% { transform: translateY(-120%); opacity:0; }
}
.card.flipped .pas-dust{ display:none; }

/* === FX: CORNER TWINKLE === */
.fx-corners{ position:absolute; inset:0; pointer-events:none; }
.fx-corners .tw{
position:absolute; width:8px; height:8px;
background:
radial-gradient(circle, #fff 0 40%, rgba(255,255,255,0) 60%),
radial-gradient(circle, #ffd700 0 30%, rgba(255,215,0,0) 70%);
border-radius:50%;
opacity:.0; transform: scale(.6) rotate(0deg);
animation: fxTwinkle 3.6s ease-in-out infinite;
}
.fx-corners .tl{ left:10px; top:10px;  animation-delay:.2s; }
.fx-corners .tr{ right:10px; top:10px; animation-delay:1.1s; }
.fx-corners .bl{ left:10px; bottom:10px;animation-delay:2.0s; }
.fx-corners .br{ right:10px; bottom:10px;animation-delay:2.7s; }

@keyframes fxTwinkle{
0%,100%{ opacity:0; transform: scale(.6) rotate(0); }
45%    { opacity:.9; transform: scale(1.15) rotate(90deg); }
70%    { opacity:.4; transform: scale(.9)  rotate(180deg); }
}
/* matikan saat flipped */
.card.flipped .fx-corners{ display:none; }

/* === FX: BUTTON ORBIT GLOW === */
.btn{ position:relative; }
.btn .fx-orbit{
position:absolute; inset:0; pointer-events:none;
border-radius:10px; transform: rotate(0deg);
animation: fxOrbit 3.8s linear infinite;
}
.btn .fx-orbit::before,
.btn .fx-orbit::after{
content:""; position:absolute; width:6px; height:6px; border-radius:50%;
background: radial-gradient(circle, #fff, rgba(255,255,255,0) 70%);
box-shadow: 0 0 6px rgba(255,255,255,.65);
}
.btn .fx-orbit::before{ left:-3px; top:50%; transform: translateY(-50%); }
.btn .fx-orbit::after { right:-3px; top:50%; transform: translateY(-50%); opacity:.6; }
@keyframes fxOrbit{ to { transform: rotate(360deg); } }

/* === FX: BREATHING HIGHLIGHT === */
.fx-breath {
position: absolute;
inset: 0;
border-radius: 16px;
pointer-events: none;
background: radial-gradient(circle at center,
rgba(255, 255, 255, 0.15) 0%,
transparent 70%
);
animation: fxBreathAnim 5s ease-in-out infinite;
}
@keyframes fxBreathAnim {
0%, 100% { opacity: 0.2; }
50% { opacity: 0.6; }
}
.card.flipped .fx-breath { display: none; }

/* === FX: RANDOM SPARK POP === */
.fx-sparkwrap { position: absolute; inset: 0; overflow: hidden; pointer-events: none; }
.fx-spark {
position: absolute;
width: 5px; height: 5px;
border-radius: 50%;
background: radial-gradient(circle, #fff, rgba(255, 255, 255, 0));
animation: fxSparkPop 1.8s ease-out forwards;
opacity: 0;
}
@keyframes fxSparkPop {
0% { transform: scale(0.5); opacity: 0; }
20% { transform: scale(1.5); opacity: 1; }
80% { opacity: 1; }
100% { transform: scale(0.5); opacity: 0; }
}
.card.flipped .fx-sparkwrap { display: none; }

/* === FX: SOFT GLOW WAVE === */
.fx-glowwave {
position: absolute;
inset: 0;
border-radius: 16px;
pointer-events: none;
background: conic-gradient(from var(--angle, 0deg),
rgba(255, 215, 0, 0.4),
rgba(255, 255, 255, 0.1),
rgba(255, 215, 0, 0.4)
);
mix-blend-mode: screen;
animation: fxGlowWaveSpin 8s linear infinite;
opacity: 0.5;
}
@keyframes fxGlowWaveSpin {
to { --angle: 360deg; }
}
.card.flipped .fx-glowwave { display: none; }

  .card.shuf-spin { transition: transform 0.6s cubic-bezier(.2,.9,.2,1); }

  /* tombol hijau saat siap memilih box */
.btn-green{
  background: linear-gradient(165deg,#22c55e 0%, #16a34a 45%, #0f7a3b 100%) !important;
  color:#fff !important;
  border-color:#0b5e2e !important;
  box-shadow:
    0 4px 0 rgba(0,0,0,.28),
    0 0 12px rgba(34,197,94,.45);
}
.btn-green:hover{
  box-shadow:
    0 6px 0 rgba(0,0,0,.30),
    0 0 16px rgba(34,197,94,.65);
  transform: translateY(-1px) scale(1.03);
}

  /* pastikan play button benar-benar sama seperti LINK LOGIN (tanpa border hitam .btn) */
.btn.btn-like-login{
  border:1px solid #b37b00 !important;
  box-shadow:
    inset 0 2px 0 rgba(255,255,255,.45),
    inset 0 -3px 8px rgba(0,0,0,.15),
    0 6px 16px rgba(179,123,0,.18) !important;
}

/* saat berubah hijau + disabled, jangan meredup */
#playBtn.btn-green:disabled{
  opacity:1 !important;
  filter:none !important;
  cursor:default !important;
}

  /* default: tombol PILIH BOX tidak terlihat */
.grid .card .front .btn{ display:none; }

  /* dasar */
#pageTitle{ text-align:center; margin:0 0 14px; }

/* DESKTOP: satu baris + emoji di kiri/kanan via pseudo-element */
#pageTitle .line1 .em{ display:none; }          /* sembunyikan emoji di dalam */
#pageTitle .line1, 
#pageTitle .line2{ display:inline; }            /* gabung jadi 1 baris */
#pageTitle::before,
#pageTitle::after{
  content:"🎁";
  display:inline;
  margin:0 .25em;
}

/* MOBILE: pecah 2 baris, emoji pindah ke baris pertama */
@media (max-width:520px){
  /* lebih besar di HP */
  #pageTitle{
    font-size: clamp(28px, 9vw, 40px); /* ← naikin batas & vw */
    line-height: 1.12;
    letter-spacing: .3px;
  }
  #pageTitle .line1, 
  #pageTitle .line2{ display:block; }
  #pageTitle::before, 
  #pageTitle::after{ content:none; }
  #pageTitle .line1 .em{ display:inline; }

  /* opsional: sedikit beda ukuran baris 2 biar proporsional */
  #pageTitle .line2{ font-size: .92em; margin-top: 2px; }
}

  #pageTitle .line1{ margin-right:.25em; }
@media (max-width:520px){ #pageTitle .line1{ margin-right:0; } }

  /* aktif ketika body punya class .is-shuffling */
.is-shuffling #grid { pointer-events: none; }             /* cegah hover/klik nyasar */
.is-shuffling .card { animation: none !important; }       /* hentikan .shake */
.is-shuffling .card:hover { transform: none !important; } /* matikan scale hover */

.is-shuffling .sparkles .sp,
.is-shuffling .pas-dust .d,
.is-shuffling .fx-glowwave,
.is-shuffling .fx-sparkwrap .fx-spark {
  animation-play-state: paused !important;
}

/* Hint GPU & isolasi paint saat bergerak */
.card { will-change: transform; contain: paint; }
.card-inner { will-change: transform; transform: translateZ(0); }

  .card.shake { animation: pasShake 4.5s ease-in-out infinite; }
.is-shuffling .card.shake { animation-play-state: paused !important; }

  /* === NX-3: OPEN FLASH (namespace nx-) === */
.nx-flash{
  position:absolute; inset:0; pointer-events:none; border-radius:16px;
  background: radial-gradient(60% 60% at 50% 50%, rgba(255,255,255,.85), rgba(255,215,0,.65) 35%, transparent 70%);
  mix-blend-mode:screen; filter:blur(2px);
  animation:nxFlash .42s ease-out forwards;
}
@keyframes nxFlash{ from{opacity:0;transform:scale(.86);} 50%{opacity:1;} to{opacity:0;transform:scale(1.08);} }
@media (prefers-reduced-motion: reduce){ .nx-flash{ animation:none !important; opacity:.3; } }

  /* === NX-4: COMETS (namespace nx-) === */
#nx-comets{ position:fixed; inset:0; pointer-events:none; z-index:10; }
.nx-comet{
  position:absolute; width:10px; height:10px; border-radius:50%;
  background: radial-gradient(circle, #fff, rgba(255,255,255,0) 65%),
              radial-gradient(circle, #ffd700, rgba(255,215,0,0) 75%);
  box-shadow: 0 0 18px rgba(255,215,0,.7);
  opacity:.95;
  transform: translate(-50%,-50%);
}
.nx-comet::after{
  content:""; position:absolute; right:50%; top:50%; height:2px; width:140px;
  transform: translateY(-50%);
  background: linear-gradient(90deg, rgba(255,215,0,.0), rgba(255,215,0,.7));
  filter: blur(1px);
}
@keyframes nxCometFly{ to{ transform: translate(-50%,-50%) translate(var(--dx), var(--dy)); opacity:0; } }
@media (prefers-reduced-motion: reduce){ #nx-comets{ display:none !important; } }

/* === NX-S5: GHOST TRAIL (nx-) === */
#nx-trails{position:fixed;inset:0;pointer-events:none;z-index:8;}
.nx-trail{
  position:absolute;border-radius:16px;overflow:hidden;will-change:transform,opacity;
}
.nx-trail::before{
  content:"";position:absolute;inset:0;border-radius:16px;
  background:
    radial-gradient(60% 60% at 50% 50%, rgba(255,255,255,.25), transparent 65%),
    linear-gradient(120deg, rgba(255,215,0,.40), rgba(255,215,0,.05));
  mix-blend-mode:screen;filter:blur(2px);opacity:.85;
}
.nx-trail::after{
  content:"";position:absolute;inset:-8px;border-radius:20px;
  background:conic-gradient(from var(--nx-ang,0deg), rgba(255,215,0,.20), rgba(255,255,255,.08), rgba(255,215,0,.20));
  filter:blur(6px);opacity:.28;mix-blend-mode:screen;
}
@media (prefers-reduced-motion: reduce){ #nx-trails{display:none!important;} }

</style>

<script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
</head>
<body>
  
<h1 id="pageTitle">
  <span class="line1"><span class="em">🎁</span> Dana Kaget <span class="em">🎁</span></span>
  <span class="line2">Papanatasslot</span>
</h1>

<div class="marquee-box">
<span class="marquee-icon">📢 :</span>
<div class="marquee-container">
<div class="marquee-text">
Deposit Minimal 100,000 Dan Dapatkan Bonus Garansi Kekalahan 100% Di Akhir Klaim Sekarang Juga !!!
</div>
</div>
</div>

<div class="input-container">
<input id="userId" class="input-gold" placeholder="Masukkan USER ID">
<input id="kupon"  class="input-gold" placeholder="Masukkan KUPON">
</div>

<!-- PLAY BUTTON -->
<div class="login-wrap" style="margin:12px 0 6px;">
  <button id="playBtn" class="btn btn-like-login" onclick="startGame()">MULAI BERMAIN</button>
</div>

<div class="grid" id="grid">
<!-- 6 cards -->
<div class="card"><div class="card-inner">
<div class="face front"><button class="btn" onclick="claim(1)">PILIH BOX</button></div>
<div class="face back"></div>
</div></div>

<div class="card"><div class="card-inner">
<div class="face front"><button class="btn" onclick="claim(2)">PILIH BOX</button></div>
<div class="face back"></div>
</div></div>

<div class="card"><div class="card-inner">
<div class="face front"><button class="btn" onclick="claim(3)">PILIH BOX</button></div>
<div class="face back"></div>
</div></div>

<div class="card"><div class="card-inner">
<div class="face front"><button class="btn" onclick="claim(4)">PILIH BOX</button></div>
<div class="face back"></div>
</div></div>

<div class="card"><div class="card-inner">
<div class="face front"><button class="btn" onclick="claim(5)">PILIH BOX</button></div>
<div class="face back"></div>
</div></div>

<div class="card"><div class="card-inner">
<div class="face front"><button class="btn" onclick="claim(6)">PILIH BOX</button></div>
<div class="face back"></div>
</div></div>
</div>

<div class="login-wrap">
<a class="login-link" href="https://papanatasslotgaming2.com" target="_top">Link Login</a>
</div>

<!-- Popup (SATU SAJA) -->
<div class="popup" id="popup" style="display:none; align-items:center; justify-content:center; position:fixed; inset:0; background:rgba(0,0,0,.82); z-index:999;">
<div class="popup-box" id="popup-content"></div>
</div>

<script>
const GAS_URL = "https://script.google.com/macros/s/AKfycbzo9sJxgcmxHmlQGy2w8kSo8ojkUIJvF_mx92ykQKAxNZxsT0SYqZnb1AoYS9A-3zCGxQ/exec";
let locked = false;

function setEnabled(enabled){
document.querySelectorAll('.btn').forEach(b=>{
b.disabled = !enabled;         // JANGAN ubah textContent di sini
});
}

// tetap boleh ada kalau mau dipakai di tempat lain
function shuffle(arr){
for(let i = arr.length - 1; i > 0; i--){
const j = Math.floor(Math.random() * (i + 1));
[arr[i], arr[j]] = [arr[j], arr[i]];
}
return arr;
}

function displayKey(v){
if (v === 100000) return 'ZONK';
if (v === 250000) return '25000';
if (v === 50000)  return '2000';
return String(v);
}

const toNum = s => parseInt(String(s).replace(/[^0-9]/g,''), 10) || 0;

async function claim(idx){
  if (locked) return;

  // tombol yang diklik
  const btn = document.querySelector(`.grid .card:nth-child(${idx}) .front .btn`);
  const restore = () => { if (btn) btn.textContent = 'PILIH BOX'; };

  // auto tutup promo
  try { hidePromo(); } catch(e) {}

  const userId = document.getElementById('userId').value.trim();
  const kupon  = document.getElementById('kupon').value.trim();
  if(!userId || !kupon){
    showAlert('Masukkan USER ID dan KUPON terlebih dahulu!', {type:'warning', title:'Data belum lengkap'});
    return;
  }

  if (btn) btn.textContent = 'Mengecek...';
  setEnabled(false);

  try {
    // === panggil backend TANPA querystring, pakai POST JSON ke /exec ===
    const res = await api('pilihBox', { userId, kupon, idx });

    if (res.status !== 'success'){
      showAlert(res.message || 'Terjadi kesalahan.', {type:'error', title:'Gagal'});
      return;
    }

    // ====== lanjut flow sukses ======
    document.querySelectorAll('.card').forEach((c, i) => {
      if (i !== (idx - 1)) {
        const b = c.querySelector('.front .btn');
        if (b) { b.classList.add('btn-hide'); b.style.display = 'none'; }
      }
    });

    const cards = document.querySelectorAll('.card');
    cards.forEach((c,i)=> setTimeout(()=> c.classList.add('flipped'), i*180));

    const pool = [4000, 6000, 10000, 50000, 100000, 250000];
    const hadiahAsli = toNum(res.hadiah);
    const hadiahKey  = displayKey(hadiahAsli);
    const others     = shuffle(pool.filter(v => displayKey(v) !== hadiahKey));

    const displayAmounts = Array(6);
    displayAmounts[idx - 1] = hadiahAsli;
    let k = 0;
    for (let i=0;i<6;i++){ if(i!==idx-1) displayAmounts[i]=others[k++]; }

    setTimeout(()=>{
      cards.forEach((c,i)=>{
        const back = c.querySelector('.back');
        const v = displayAmounts[i];
        const isZonk = (v === 100000);
        let shownV = v;
        if (v === 250000) shownV = 25000;
        else if (v === 50000) shownV = 2000;
        const labelRp = `Rp ${shownV.toLocaleString('id-ID')}`;

        if (isZonk) {
          c.classList.add('zonk-box');
          back.innerHTML = `<div class="zonk-label">ZONK !</div>`;
        } else if (i === (idx - 1)) {
          c.classList.add('selected-box');
          back.innerHTML = `
            <div class="saldo-wrap">
              <div class="saldo-title">SALDO AKUN</div>
              <div class="saldo-amount">${labelRp}</div>
            </div>`;
        } else {
          back.innerHTML = `<div class="fake-amount">${labelRp}</div>`;
        }
      });
    }, 260);

    setTimeout(()=>{
      document.getElementById('popup-content').innerHTML = `
        <button class="popup-x" aria-label="Tutup"
          onclick="document.getElementById('popup').style.display='none'">✖</button>
        <div class="pas-popup">
          <img class="pas-brand"
            src="https://raw.githubusercontent.com/simen99/danakaget-papanataslot1/e02f8a4f84748a98fbfc25bccb2fb8a207d38073/assets/papanatasslot-logo%20(1).png"
            alt="Papan Atas Slot">
          <div class="pas-subtitle">Anda mendapatkan</div>
          <div class="pas-amount">IDR ${hadiahAsli.toLocaleString('id-ID')}</div>
          <div class="pas-meta">Coupon Code : <b>${res.kupon}</b></div>
          <div class="pas-meta">Username : <b>${(res.username || res.userId || '-')}</b></div>
          <div class="pas-hint">SCREENSHOT DAN KLAIM HADIAH MELALUI WHATSAPP ATAU TELEGRAM</div>
          <div class="pas-btn-row">
            <a href="https://klikblg.com/wa-pas"   target="_blank" rel="noopener" class="pas-btn pas-wa">KLAIM WA</a>
            <a href="https://klikblg.com/tele-pas" target="_blank" rel="noopener" class="pas-btn pas-tg">KLAIM TELE</a>
          </div>
          <button type="button" class="pas-btn pas-reset"
            onclick="document.getElementById('popup').style.display='none'; resetBoxes();">
            PILIH BOX LAGI
          </button>
        </div>`;
      document.getElementById('popup').style.display = 'flex';

      requestAnimationFrame(()=>{
        const myCanvas = document.getElementById('confetti-canvas');
        const myConfetti = confetti.create(myCanvas, { resize: true, useWorker: true });
        myConfetti({ particleCount: 160, spread: 70, origin: { y: 0.6 } });
      });

      locked = true;
    }, cards.length*120 + 360 + 3000);

  } catch (err) {
    console.error(err);
    showAlert('Gagal menghubungi server. Coba lagi.', { type:'error', title:'Jaringan bermasalah' });
  } finally {
    restore();
    setEnabled(true);
  }
}
</script>

<!-- Tombol Mengambang Telegram & WhatsApp -->
<a href="https://klikblg.com/tele-pas" target="_blank" class="floating-btn" style="bottom: 180px;">
<img src="https://raw.githubusercontent.com/simen99/danakaget-papanataslot1/a3212421aa2f9802217f82aa7a1561aae853ecf3/assets/telegram-gif.gif" alt="Telegram" />
</a>

<a href="https://klikblg.com/wa-pas" target="_blank" class="floating-btn" style="bottom: 110px;">
<img src="https://raw.githubusercontent.com/simen99/danakaget-papanataslot1/3217ee27d0a7009dae26ec46842083d6b1f7aba8/assets/whats-app.gif" alt="whatsapp" />
</a>

<a href="https://tawk.to/chat/680c7b424b378d190bfa1983/1ipoc2vkj"
target="_blank"
class="floating-btn livechat"
style="bottom: 259px;">
<img src="https://raw.githubusercontent.com/simen99/danakaget-papanataslot1/bac709c8a2eaa772a7233bd7fb86015088362115/assets/livechat.gif" alt="Livechat" />
</a>

<script>
function haptic(ms=8){ try{ if(navigator.vibrate) navigator.vibrate(ms); }catch{} }
document.querySelectorAll('.btn').forEach(b=>{
b.addEventListener('click', ()=> haptic(10));
});
</script>

  <script>
/* ====== STATE & UTIL ====== */
let canPick = false;   // baru boleh pilih box setelah shuffle selesai
let isShuffling = false;

/* (OPSIONAL) Cek ke server dulu sebelum shuffle.
   Kalau backend kamu BELUM ada action=cekKupon:
   - Biarin saja fungsi ini hanya cek kosong (frontend),
   - Atau ganti 'action' sesuai di GAS kamu. */
async function validateKuponServer(userId, kupon){
  try{
    const res   = await api('cekKupon', { userId, kupon });
    const used  = !!res.used;
    const allow = !!res.allow;
    // OK hanya jika allow === true dan belum digunakan
    return {
      ok: (allow && !used),
      used,
      res,
      message: res.message || ''
    };
  }catch(err){
    console.error('cekKupon error:', err);
    return { ok:false, used:false, message:String(err.message||err) };
  }
}
    
/* ====== ANIMASI SHUFFLE (FLIP technique) ======
   Kita siapkan 5 POLA (permutasi index 1..6) dan jalankan berturut-turut biar terlihat "mengacak".
   Hasil akhirnya DOM benar-benar diacak (susunan card berubah). */
const SHUFFLE_PATTERNS = [
  [6,1,5,3,2,4],
  [2,3,1,6,4,5],
  [4,2,6,1,5,3],
  [3,6,2,5,1,4],
  [5,1,3,2,6,4],
];

function delay(ms){ return new Promise(r=>setTimeout(r, ms)); }

async function flipReorder(order, opts = {}) {
  const { duration = 900, easing = 'cubic-bezier(.22,.8,.22,1)' } = opts;

  const grid  = document.getElementById('grid');
  const cards = Array.from(grid.children);
  const first = cards.map(el => el.getBoundingClientRect());

  const newOrder = order.map(i => cards[i-1]);
  newOrder.forEach(el => grid.appendChild(el));

  const last = newOrder.map(el => el.getBoundingClientRect());

  // Set posisi awal (tanpa transisi) → pakai 3D biar ke GPU
  newOrder.forEach((el, i) => {
    const oldIndex = cards.indexOf(el);
    const dx = first[oldIndex].left - last[i].left;
    const dy = first[oldIndex].top  - last[i].top;
    const rot = (Math.random()*0.6 - 0.3).toFixed(2);

    el.style.transition = 'transform 0s';
    el.style.transform  = `translate3d(${dx}px, ${dy}px, 0) rotate(${rot}deg)`;
  });

  // Pastikan browser commit style dulu → lalu baru transisi ke 0
  await new Promise(r => requestAnimationFrame(() => requestAnimationFrame(r)));

  newOrder.forEach((el) => {
    el.style.transition = `transform ${duration}ms ${easing}`;
    el.style.transform  = 'translate3d(0,0,0) rotate(0deg)';
  });

  await delay(duration + 40);
}

/* Jalankan 4 langkah shuffle (acak urutan polanya) */
async function runShuffle(){
  if (isShuffling) return;
  isShuffling = true;
  document.body.classList.add('is-shuffling');   // ← aktifkan mode

  const seq = [];
  const pool = [...SHUFFLE_PATTERNS];
  for(let i=0;i<5;i++){
    const pick = Math.floor(Math.random()*pool.length);
    seq.push(pool[pick]);
    pool.push(pool.splice(pick,1)[0]);
  }

  try{
    for (const pat of seq){
      await flipReorder(pat, { duration: 1100, easing: 'cubic-bezier(.22,.8,.22,1)' });
      await delay(220);
    }
  } finally {
    document.body.classList.remove('is-shuffling'); // ← matikan mode
    isShuffling = false;
  }
}
    
function reindexPickButtons(){
  document.querySelectorAll('#grid .card').forEach((card, i) => {
    const btn = card.querySelector('.front .btn');
    if (btn) btn.setAttribute('onclick', `claim(${i+1})`);
  });
}

/* ====== START GAME FLOW ====== */
async function startGame(){
  if (locked || isShuffling) return;
  if (canPick) {
    showAlert('Box sudah diacak. Silakan pilih salah satu.', {type:'info', title:'Sudah diacak'});
    return;
  }

  const btn    = document.getElementById('playBtn');
  const userId = document.getElementById('userId').value.trim();
  const kupon  = document.getElementById('kupon').value.trim();

  if (!userId || !kupon){
    showAlert('Masukkan USER ID dan KUPON terlebih dahulu!', {type:'warning', title:'Data belum lengkap'});
    return;
  }

  // Kunci tombol & mulai cek
  setEnabled(false);
  btn.textContent = 'Mengecek…';

  // ===== VALIDASI KE SERVER DULU =====
  const check = await validateKuponServer(userId, kupon);

  if (!check.ok){
    // Jika kupon sudah dipakai -> info; kalau tidak valid / gagal -> error
    const type  = check.used ? 'info' : 'error';
    const title = check.used ? 'Kupon sudah digunakan' : 'Validasi gagal';
    const msg   = check.message || (check.used
      ? 'Kupon ini sudah pernah dipakai untuk klaim.'
      : 'Kupon tidak valid / gagal diverifikasi.');

    showAlert(msg, {type, title});

    // Pulihkan tombol dan state
    btn.textContent = 'MULAI BERMAIN';
    setEnabled(true);
    return;
  }

  // ===== LOLOS VALIDASI → PREVIEW → SHUFFLE =====
btn.textContent = 'MENAMPILKAN HADIAH…';

// sembunyikan tombol PILIH BOX saat preview
document.querySelectorAll('.front .btn').forEach(b => b.style.display = 'none');

// 1) TAMPILKAN SEMUA HADIAH SEBENTAR
await showPreview(2000); // atur durasi tampil (ms) suka-suka

// 2) LALU MULAI MENGACAK
btn.textContent = 'MENGACAK…';
try { if (navigator.vibrate) navigator.vibrate(18); } catch {}
await runShuffle();
reindexPickButtons();

// 3) SELESAI ACAK → BOLEH PILIH
canPick = true;
btn.textContent = 'SILAHKAN PILIH BOX';
btn.classList.add('btn-green');
document.querySelectorAll('.front .btn').forEach(b => b.style.display = 'inline-block');
setEnabled(true);
btn.disabled = true;
btn.title = 'Box sudah diacak. Pilih salah satu.';
}
</script>

<script>
let cool = false;
function coolDown(ms=1200){
cool = true; setTimeout(()=> cool = false, ms);
}

const _claimOrig = claim; // simpan referensi aslinya
window.claim = async function(idx){
  if (!canPick){
    showAlert('Klik tombol "MULAI BERMAIN" dulu untuk mengacak box.', {type:'info', title:'Belum mulai'});
    return;
  }
  if (cool) return;
  coolDown();
  await _claimOrig(idx);
}
</script>

<canvas id="confetti-canvas"></canvas>

<!-- Promo Popup -->
<div id="promoPopup" class="promo-overlay" aria-modal="true" role="dialog">
<div class="promo-box">
<button class="promo-close" aria-label="Tutup" onclick="hidePromo()">✖</button>
<a href="https://papanatasslotgaming2.com" target="_top" rel="noopener">
<img src="https://raw.githubusercontent.com/simen99/danakaget-papanataslot1/5da96eac222c77869c4f22c38e80e344e7416ac7/assets/fb5ca8536c68171ee0298231f21656bd.jpg"
alt="Promo - Event - Bonus">
</a>
</div>
</div>

<script>
function showPromo(){ document.getElementById('promoPopup').style.display='flex'; }
function hidePromo(){ document.getElementById('promoPopup').style.display='none'; }

// Muncul saat pertama kali buka / refresh
document.addEventListener('DOMContentLoaded', showPromo);

// Tutup dengan ESC
document.addEventListener('keydown', e=>{
const el = document.getElementById('promoPopup');
if (e.key === 'Escape' && el.style.display === 'flex') hidePromo();
});
</script>

<script>
function showAlert(message, { type='warning', title='Pemberitahuan', autoclose=0 } = {}){
const el = document.getElementById('alertModal');
const iconMap = { success:'✅', warning:'⚠️', error:'⛔', info:'ℹ️' };

el.dataset.type = type; // tema warna via CSS
document.getElementById('alertIcon').textContent = iconMap[type] || '⚠️';
document.getElementById('alertTitle').textContent = title;
document.getElementById('alertMsg').textContent = message;

// progress bar (opsional)
const bar = document.getElementById('alertProgress');
if (autoclose > 0 && bar){
bar.style.display = 'block';
bar.querySelector('.fill').style.animationDuration = autoclose + 'ms';
} else if (bar){
bar.style.display = 'none';
}

el.style.display = 'flex';
void el.offsetWidth;            // reflow
el.classList.add('show');       // kelas animasi

const esc = (e)=>{ if(e.key==='Escape') hideAlert(); };
el._esc = esc; document.addEventListener('keydown', esc);

if (autoclose > 0){
clearTimeout(el._t); el._t = setTimeout(hideAlert, autoclose);
}
}

function hideAlert(){
const el = document.getElementById('alertModal');
el.classList.remove('show');
setTimeout(()=>{ el.style.display='none'; }, 250); // tunggu transisi
if (el._esc){ document.removeEventListener('keydown', el._esc); el._esc=null; }
}
</script>

<script>
document.addEventListener('DOMContentLoaded', () => {
document.querySelectorAll('.card').forEach((c, i) => {
c.classList.add('shake');
c.style.setProperty('--shake-delay', (i * 0.3) + 's'); // beda-beda jedanya
});
});
</script>

<script>
document.querySelectorAll('.btn').forEach(btn=>{
btn.addEventListener('click', e=>{
const d = Math.max(btn.clientWidth, btn.clientHeight);
const ripple = document.createElement('span');
ripple.className = 'ripple';
ripple.style.width = ripple.style.height = d+'px';
const rect = btn.getBoundingClientRect();
ripple.style.left = (e.clientX - rect.left - d/2)+'px';
ripple.style.top  = (e.clientY - rect.top  - d/2)+'px';
btn.appendChild(ripple);
setTimeout(()=> ripple.remove(), 650);
});
});
</script>

<script>
document.addEventListener('DOMContentLoaded', ()=>{
const perCard = 5; // jumlah bintik per kartu
document.querySelectorAll('.card .face.front').forEach((face)=>{
const wrap = document.createElement('div');
wrap.className = 'sparkles';
for(let i=0;i<perCard;i++){
const sp = document.createElement('span');
sp.className = 'sp';
// posisi acak di dalam kartu
sp.style.left = (Math.random()*88 + 6) + '%';
sp.style.top  = (Math.random()*78 + 8) + '%';
// waktu & delay acak
sp.style.setProperty('--sp-dur',  (1.8 + Math.random()*1.8).toFixed(2)+'s');
sp.style.setProperty('--sp-delay',(Math.random()*2.4).toFixed(2)+'s');
// ukuran acak
const s = (Math.random()*5 + 3).toFixed(0);
sp.style.width = sp.style.height = s+'px';
wrap.appendChild(sp);
}
face.appendChild(wrap);
});
});
</script>

<script>
document.addEventListener('DOMContentLoaded', ()=>{
if(!document.getElementById('pas-bokeh')){
const bg = document.createElement('div');
bg.id = 'pas-bokeh';
document.body.appendChild(bg);
// buat 18 partikel
for(let i=0;i<18;i++){
const d = document.createElement('div');
d.className = 'bokeh-dot';
const size = Math.random()*90 + 30; // 30–120 px
d.style.width = d.style.height = size+'px';
d.style.left = (Math.random()*100)+'vw';
d.style.setProperty('--bk-scale', (Math.random()*0.5+0.7).toFixed(2));
d.style.setProperty('--bk-dur', (14 + Math.random()*16).toFixed(1)+'s');
d.style.setProperty('--bk-dx',  (Math.random()*160 - 80).toFixed(0)+'px');
d.style.animationDelay = (-Math.random()*20).toFixed(2)+'s'; // desync
bg.appendChild(d);
}
}
});
</script>


<script>
document.addEventListener('DOMContentLoaded', ()=>{
const perCard = 8;  // jumlah debu per kartu (halus)
document.querySelectorAll('.card .face.front').forEach(face=>{
const w = document.createElement('div');
w.className = 'pas-dust';
for(let i=0;i<perCard;i++){
const dot = document.createElement('span');
dot.className = 'd';
const size = (Math.random()*6 + 3).toFixed(0); // 3–9px
dot.style.width = dot.style.height = size+'px';
dot.style.left = (Math.random()*92) + '%';
dot.style.top  = (Math.random()*100) + '%';
dot.style.animationDuration = (9 + Math.random()*6).toFixed(1)+'s';
dot.style.animationDelay    = (-Math.random()*10).toFixed(2)+'s'; // desync
// sedikit drift horizontal acak
const dx = (Math.random()*40-20).toFixed(0);
dot.style.setProperty('--dx', dx+'px');
dot.style.transform = `translateX(0)`;
w.appendChild(dot);
}
face.appendChild(w);
});
});
</script>

<script>
document.addEventListener('DOMContentLoaded', ()=>{
document.querySelectorAll('.card .front').forEach(front=>{
const wrap = document.createElement('div');
wrap.className = 'fx-corners';
['tl','tr','bl','br'].forEach(p=>{
const s = document.createElement('span');
s.className = 'tw ' + p;
wrap.appendChild(s);
});
front.appendChild(wrap);
});
});
</script>

<script>
document.addEventListener('DOMContentLoaded', ()=>{
document.querySelectorAll('.front .btn').forEach(b=>{
const o = document.createElement('span');
o.className = 'fx-orbit';
b.appendChild(o);
});
});
</script>

<script>
document.addEventListener('DOMContentLoaded', () => {
document.querySelectorAll('.card .front').forEach(front => {
const breath = document.createElement('div');
breath.className = 'fx-breath';
front.appendChild(breath);
});
});
</script>

<script>
document.addEventListener('DOMContentLoaded', () => {
document.querySelectorAll('.card .front').forEach(front => {
const wrap = document.createElement('div');
wrap.className = 'fx-sparkwrap';
front.appendChild(wrap);

setInterval(() => {
const s = document.createElement('span');
s.className = 'fx-spark';
const size = Math.random() * 4 + 3;
s.style.width = s.style.height = size + 'px';
s.style.left = Math.random() * 90 + '%';
s.style.top = Math.random() * 90 + '%';
wrap.appendChild(s);
setTimeout(() => s.remove(), 2000);
}, 1200);
});
});
</script>

  <script>
async function api(action, data){
  const ctrl = new AbortController();
  const t = setTimeout(()=>ctrl.abort('timeout'), 12000); // biar jelas kalau timeout

  const r = await fetch(GAS_URL, {
    method: 'POST',
    headers: { 'Content-Type': 'text/plain;charset=utf-8' }, // ⬅️ ubah ini
    cache: 'no-store',
    body: JSON.stringify({ action, ...data }),
    signal: ctrl.signal
  }).catch(err=>{
    throw new Error(err.name==='AbortError' ? 'Waktu koneksi habis.' : 'Tidak bisa menghubungi server.');
  });

  const text = await r.text();
  let res;
  try { res = JSON.parse(text); }
  catch { throw new Error('Balasan bukan JSON: ' + text.slice(0,120)); }

  if (!r.ok) throw new Error('HTTP ' + r.status + ' — ' + (res.message || ''));
  return res; // ekspektasi: { status: 'success', ... }
}
</script>

  <script>
function resetBoxes(){
  const cards = document.querySelectorAll('.card');

  // reset tampilan kartu
  cards.forEach(card => {
    card.classList.remove('flipped','selected-box','zonk-box');
    const back = card.querySelector('.back');
    if (back) back.innerHTML = '';
  });

  // sembunyikan kembali tombol "PILIH BOX" (balik ke CSS default)
  document.querySelectorAll('.front .btn').forEach(b => {
    b.classList.remove('btn-hide');
    b.style.removeProperty('display');
  });

  // tutup popup
  const pop = document.getElementById('popup');
  if (pop) pop.style.display = 'none';

  // reset state permainan
  locked = false;
  canPick = false;
  isShuffling = false;

  // pulihkan tombol MULAI
  const pb = document.getElementById('playBtn');
  if (pb){
    pb.disabled = false;
    pb.textContent = 'MULAI BERMAIN';
    pb.title = '';
    pb.classList.remove('btn-green');
  }

  // (opsional) kosongkan input
  // document.getElementById('userId').value = '';
  // document.getElementById('kupon').value  = '';

  // (opsional) tampilkan lagi promo
  // showPromo();
}
</script>

<script>
document.addEventListener('DOMContentLoaded', () => {
document.querySelectorAll('.card .front').forEach(front => {
const glow = document.createElement('div');
glow.className = 'fx-glowwave';
front.appendChild(glow);
});
});
</script>

  <script>
const PREVIEW_POOL = [4000, 6000, 10000, 50000, 100000, 250000];

async function showPreview(showMs = 2400){
  const cards = [...document.querySelectorAll('.card')];

  // sembunyikan tombol pilih
  document.querySelectorAll('.front .btn').forEach(b => b.style.display = 'none');

  // isi sisi belakang untuk preview
  const preview = shuffle([...PREVIEW_POOL]);
  cards.forEach((c,i)=>{
    const v = preview[i % preview.length];
    const back = c.querySelector('.back');
    const isZonk = (v === 100000);
    let shownV = v;
    if (v === 250000) shownV = 25000;
    else if (v === 50000) shownV = 2000;

    c.classList.toggle('zonk-box', isZonk);
    back.innerHTML = isZonk
      ? `<div class="zonk-label">ZONK !</div>`
      : `<div class="fake-amount">Rp ${shownV.toLocaleString('id-ID')}</div>`;
  });

  // buka semua kartu berantai → tahan → tutup lagi berantai (reverse)
  await flipCascade(cards, true, 160);
  await delay(showMs);
  await flipCascade(cards.slice().reverse(), false, 160);

  // bersih-bersih isi & kelas
  cards.forEach(c=>{
    c.classList.remove('zonk-box','selected-box');
    c.querySelector('.back').innerHTML = '';
  });

  // buffer kecil sebelum mulai shuffle
  await delay(140);
}
</script>

  <script>
// tunggu sampai transition transform pada .card-inner selesai
function waitEnd(inner){
  return new Promise(resolve=>{
    const onEnd = (e)=>{
      if (e.propertyName === 'transform'){
        inner.removeEventListener('transitionend', onEnd);
        resolve();
      }
    };
    inner.addEventListener('transitionend', onEnd);
  });
}

// flip berantai (open=true buka, open=false tutup)
async function flipCascade(list, open=true, step=160){
  for (const card of list){
    const inner = card.querySelector('.card-inner');
    if (open) card.classList.add('flipped'); else card.classList.remove('flipped');
    // mulai kartu berikutnya sedikit lebih awal, tapi tetap tunggu yang terakhir
    await Promise.race([waitEnd(inner), delay(step)]);
  }
  const lastInner = list[list.length-1]?.querySelector('.card-inner');
  if (lastInner) await waitEnd(lastInner);
}
</script>

  <script>
/* === NX-3: deteksi .flipped via MutationObserver, injeksi flash 1x === */
(function(){
  const grid = document.getElementById('grid');
  if (!grid) return;
  const seen = new WeakSet();
  const obs = new MutationObserver(muts=>{
    muts.forEach(m=>{
      m.addedNodes && m.addedNodes.forEach(()=>{ /* noop */ });
      if (m.target && m.target.classList && m.target.classList.contains('card') && m.attributeName==='class'){
        const card = m.target;
        if (card.classList.contains('flipped') && !seen.has(card)){
          seen.add(card);
          const back = card.querySelector('.back');
          if (back){
            const fx = document.createElement('span');
            fx.className = 'nx-flash';
            back.appendChild(fx);
            setTimeout(()=> fx.remove(), 500);
          }
        }
      }
    });
  });
  obs.observe(grid, { attributes:true, subtree:true, attributeFilter:['class'] });
})();
</script>

  <script>
/* === NX-4: spawn komet 1x tiap ~4s, sangat ringan === */
document.addEventListener('DOMContentLoaded', ()=>{
  if (window.matchMedia('(prefers-reduced-motion: reduce)').matches) return;
  if (document.getElementById('nx-comets')) return;
  const host = document.createElement('div'); host.id='nx-comets'; document.body.appendChild(host);
  setInterval(()=>{
    const s = document.createElement('span'); s.className='nx-comet';
    const x = Math.random()*window.innerWidth*0.8 + window.innerWidth*0.1;
    const y = Math.random()*window.innerHeight*0.2 + window.innerHeight*0.1;
    s.style.left = x+'px'; s.style.top = y+'px';
    const dx = (-window.innerWidth*0.5) + 'px';
    const dy = (window.innerHeight*(Math.random()*0.6+0.2)) + 'px';
    s.style.setProperty('--dx', dx);
    s.style.setProperty('--dy', dy);
    const dur = (1600 + Math.random()*900) + 'ms';
    s.style.animation = `nxCometFly ${dur} ease-out forwards`;
    host.appendChild(s);
    setTimeout(()=> s.remove(), 2600);
  }, 4000);
});
</script>

  <script>
/* NX-S5: buat "ghost" di posisi awal kartu saat mulai transisi transform */
(function(){
  const grid = document.getElementById('grid'); if(!grid) return;
  let host = document.getElementById('nx-trails');
  if(!host){ host = document.createElement('div'); host.id='nx-trails'; document.body.appendChild(host); }

  function parseTranslate(el){
    const m = getComputedStyle(el).transform;
    if(!m || m === 'none') return {x:0,y:0};
    if(m.startsWith('matrix3d(')){ const a = m.slice(9,-1).split(',').map(Number); return {x:a[12]||0, y:a[13]||0}; }
    if(m.startsWith('matrix(')){ const a = m.slice(7,-1).split(',').map(Number); return {x:a[4]||0, y:a[5]||0}; }
    return {x:0,y:0};
  }
  function durMs(el){
    const cs = getComputedStyle(el);
    const durs = cs.transitionDuration.split(',').map(s=>s.trim());
    const props = cs.transitionProperty.split(',').map(s=>s.trim());
    const idx = props.findIndex(p=>p==='transform');
    const raw = (idx>=0? durs[idx] : durs[0]) || '0.9s';
    return raw.endsWith('ms') ? parseFloat(raw) : parseFloat(raw)*1000;
  }
  grid.addEventListener('transitionstart', (e)=>{
    if(e.propertyName!=='transform') return;
    if(!document.body.classList.contains('is-shuffling')) return;
    const card = e.target.closest('.card'); if(!card) return;

    const rect = card.getBoundingClientRect();
    const {x, y} = parseTranslate(e.target);          // kartu akan bergerak dari (x,y) -> (0,0)
    const angle = Math.atan2(-y, -x) * 180/Math.PI;    // arah gerak
    const t = document.createElement('span');
    t.className = 'nx-trail';
    t.style.left = rect.left + 'px';
    t.style.top  = rect.top  + 'px';
    t.style.width  = rect.width + 'px';
    t.style.height = rect.height+ 'px';
    t.style.setProperty('--nx-ang', angle + 'deg');
    host.appendChild(t);

    const d = Math.max(380, durMs(e.target)*0.9);
    t.animate(
      [{ transform:'translate(0,0) scale(.98)', opacity:.65 },
       { transform:`translate(${-x}px,${-y}px) scale(1.06)`, opacity:0 }],
      { duration:d, easing:'cubic-bezier(.22,.8,.22,1)' }
    ).onfinish = ()=> t.remove();
  }, true);
})();
</script>
  
<!-- Modalnya di paling akhir body -->
<div id="alertModal" class="alert-overlay" style="display:none" aria-modal="true" role="dialog">
<div class="alert-box" role="document">
<button class="alert-close" aria-label="Tutup" onclick="hideAlert()">✖</button>
<div class="alert-icon" id="alertIcon">⚠️</div>
<div class="alert-title" id="alertTitle">Pemberitahuan</div>
<div class="alert-msg" id="alertMsg">Pesan di sini…</div>
<div class="alert-actions">
<button class="btn-alert" onclick="hideAlert()">Oke</button>
</div>
<div class="alert-progress" id="alertProgress" style="display:none;">
<span class="fill"></span>
</div>
</div>
</div>

</body>
</html>
