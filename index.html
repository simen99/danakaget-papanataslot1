<!DOCTYPE html>
<html>
<head>
  <title>Papanatasslot - Dana Kaget</title>
  <link rel="icon" type="image/png" href="https://i.ibb.co/LzZ7kXMj/049b1ca3-db9f-42b9-980d-7363faac5600.png">
  <base target="_top">
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">
  <!-- Fonts -->
  <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@600;800&family=Poppins:wght@400;600&family=Russo+One&display=swap" rel="stylesheet">
  <style>
    :root{ --gold1:#ffd700; --gold2:#f5c013; --gold3:#b8860b; }
    body{ margin:0; background:#111; color:#fff; text-align:center; padding:24px 12px; font-family:'Poppins',sans-serif; }
    h1{ font-family:'Orbitron',sans-serif; color:#ffcc00; letter-spacing:.5px; margin:0 0 14px; font-size:30px; }

    /* Inputs */
    .input-container{
  display:flex;
  flex-direction:column;    /* urut vertikal */
  align-items:center;       /* tengah */
  gap:10px;                 /* jarak antar input */
}
    .input-gold{
  width:240px;
  padding:12px 14px 12px 46px; /* space untuk ikon kiri */
  border-radius:14px;
  border:1px solid #b37b00;
  background:
    radial-gradient(120% 80% at 30% 0%, rgba(255,255,255,.35) 0%, rgba(255,255,255,0) 60%),
    linear-gradient(165deg,#ffe27a 0%, #f1c232 40%, #d8a700 100%);
  color:#1a1300;
  font-weight:700;
  letter-spacing:.2px;
  outline:0;
  transition:transform .18s ease, box-shadow .2s ease, border-color .2s ease, filter .2s ease;
  box-shadow:
    inset 0 2px 0 rgba(255,255,255,.45),
    inset 0 -3px 8px rgba(0,0,0,.15),
    0 6px 16px rgba(179,123,0,.18);
  backdrop-filter: saturate(1.1);
}
   .input-gold::placeholder{
  color: rgba(26,19,0,.8); /* lebih pekat, tetap elegan */
  text-transform: uppercase;
  letter-spacing: .6px;
  font-weight: 800;
  text-shadow: 0 1px 0 rgba(255,255,255,.35);
}
    .input-gold:hover,.input-gold:focus{
  transform: translateY(-1px);
  border-color:#ffcf33;
  box-shadow:
    inset 0 2px 0 rgba(255,255,255,.55),
    inset 0 -3px 10px rgba(0,0,0,.18),
    0 0 0 3px rgba(255,207,51,.28),
    0 10px 22px rgba(255,215,0,.25);
  filter: saturate(1.08);
}

    /* Card (flip) */
    .card{ width:180px; height:180px; perspective:1000px; }
    .card-inner{
      position:relative; width:100%; height:100%; transform-style:preserve-3d;
      transition:transform .6s ease;
    }
    /* Ikon kiri tanpa ubah HTML */
#userId{
  background:
    url("data:image/svg+xml,%3Csvg width='22' height='22' viewBox='0 0 24 24' fill='none' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M12 12a5 5 0 1 0-5-5 5 5 0 0 0 5 5Zm0 2c-4.418 0-8 2.239-8 5v1h16v-1c0-2.761-3.582-5-8-5Z' fill='%231a1300'/%3E%3C/svg%3E") no-repeat 14px 50% / 22px,
    radial-gradient(120% 80% at 30% 0%, rgba(255,255,255,.35) 0%, rgba(255,255,255,0) 60%),
    linear-gradient(165deg,#ffe27a 0%, #f1c232 40%, #d8a700 100%);
}

#kupon{
  background:
    url("data:image/svg+xml,%3Csvg width='22' height='22' viewBox='0 0 24 24' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath fill='%231a1300' d='M3 7a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2v2a2 2 0 1 0 0 4v2a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-2a2 2 0 1 0 0-4Zm6 1h2v8H9Zm4 0h2v8h-2Z'/%3E%3C/svg%3E") no-repeat 14px 50% / 22px,
    radial-gradient(120% 80% at 30% 0%, rgba(255,255,255,.35) 0%, rgba(255,255,255,0) 60%),
    linear-gradient(165deg,#ffe27a 0%, #f1c232 40%, #d8a700 100%);
}
    .card.flipped .card-inner{ transform:rotateY(180deg); }

    .face{
      position:absolute; inset:0; border-radius:16px; overflow:hidden;
      box-shadow:0 0 10px rgba(255,215,0,.7);
      display:flex; align-items:flex-end; justify-content:center;
      backface-visibility:hidden;
    }
    .front{
      background-image:url('https://i.ibb.co/zVbhV11C/dana-kaget-spesial-weekend.jpg');
      background-size:cover; background-position:center;
      padding:10px;
    }
    .back{
      transform:rotateY(180deg);
      background:linear-gradient(160deg,var(--gold1) 0%,var(--gold2) 50%,var(--gold3) 100%);
      color:#111; display:flex; align-items:center; justify-content:center;
    }

    /* Button */
    .btn{
      padding:9px 14px; margin-bottom:10px; border:0; border-radius:10px;
      background:#ffcc00; color:#111; font-weight:900; cursor:pointer;
      transition:transform .15s, box-shadow .2s; animation:pulse 1.5s infinite;
      box-shadow:0 4px 0 rgba(0,0,0,.25), 0 0 0 rgba(255,215,0,0);
    }
    .btn:hover{ transform:translateY(-1px) scale(1.03); box-shadow:0 6px 0 rgba(0,0,0,.28), 0 0 12px rgba(255,215,0,.8); }
    .btn:disabled{ opacity:.6; cursor:not-allowed; animation:none; }
    @keyframes pulse{
      0%{box-shadow:0 4px 0 rgba(0,0,0,.25),0 0 0 rgba(255,215,0,0)}
      50%{box-shadow:0 4px 0 rgba(0,0,0,.25),0 0 14px rgba(255,215,0,.9)}
      100%{box-shadow:0 4px 0 rgba(0,0,0,.25),0 0 0 rgba(255,215,0,0)}
    }

    /* Back contents */
    .saldo-wrap{ text-align:center; }
    .saldo-title{ font-weight:900; letter-spacing:.6px; margin-bottom:6px; }
    .saldo-amount{ font-family:'Russo One',sans-serif; font-size:22px; }

    .fake-amount{ font-family:'Russo One',sans-serif; font-size:20px; }

 /* ==== POPUP HADIAH — FINAL (3 tombol rapi) ==== */
#popup .popup-box{
  width: min(92%, 380px) !important;
  padding: 22px !important;
  border-radius: 16px !important;
}

.pas-popup { font-family:'Poppins',sans-serif; text-align:center; }
.pas-popup .pas-brand { width:170px; margin:0 auto 8px; }
.pas-popup .pas-subtitle { margin:4px 0 6px; font-weight:800; }
.pas-popup .pas-amount {
  color:#e30606; font-weight:900; font-size:36px;
  font-family:'Russo One',sans-serif;
}
.pas-popup .pas-meta { font-size:14px; margin:2px 0; font-weight:700; }
.pas-popup .pas-hint {
  margin:12px auto; padding:10px 12px; max-width:340px;
  border-radius:10px; background:#efefef; font-weight:800;
}

.pas-btn{
  display:block;
  width:min(100%,340px);
  margin:6px auto;
  padding:12px;
  border:none;
  border-radius:12px;
  font-weight:900;
  color:#fff;
  text-decoration:none;
  cursor:pointer;
  transition:transform .15s ease, filter .2s ease;
}
.pas-btn:hover{ transform:translateY(-1px); filter:brightness(1.05); }
.pas-wa{ background:#16a34a; }
.pas-tg{ background:#1d9bf0; }
.pas-reset{ background:#2563eb; }

/* HP kecil: tombol klaim ditumpuk */
@media (max-width:360px){
  .pas-btn-row{ flex-direction:column; }
}

.pas-btn-row{
  display:flex;
  gap:10px;
  justify-content:center;
  align-items:center;
  max-width:340px;
  margin:10px auto 8px;
}

/* override ukuran tombol saat di dalam baris flex */
.pas-btn-row .pas-btn{
  flex:1;
  width:auto;      /* jangan full width */
  margin:0;        /* hilangkan margin auto bawaan */
}

/* === Glow emas per-box saat kursor mengarah === */
.card {
  cursor: pointer;
  border-radius: 16px; /* samakan dengan sudut box isi */
  transition: box-shadow .25s ease, transform .2s ease;
}
.card:hover {
  box-shadow:
    0 0 12px rgba(255,215,0,.95),
    0 0 28px rgba(255,215,0,.60),
    0 0 44px rgba(255,215,0,.35);
  transform: scale(1.02);
}

/* === Tombol "PILIH BOX" dibungkus garis hitam === */
.btn{
  border: 2px solid #000 !important;   /* garis hitam */
  box-shadow:
    0 4px 0 rgba(0,0,0,.25),
    0 0 0 rgba(255,215,0,0);
}
.btn:hover{
  border-color:#000;
  box-shadow:
    0 6px 0 rgba(0,0,0,.28),
    0 0 12px rgba(255,215,0,.8);
}
/* aksesibilitas (keyboard focus) */
.btn:focus-visible{
  outline: 2px solid #000;
  outline-offset: 2px;
}

/* Tombol Mengambang Kiri */
.floating-btn {
  position: fixed;
  left: 20px;          /* jarak dari kiri */
  z-index: 9999;
  display: inline-block;
  transition: transform 0.25s ease;
}
.floating-btn img {
  width: 60px;         /* ukuran tombol */
  height: auto;
  border-radius: 50%;
  box-shadow: 0 4px 12px rgba(0,0,0,0.4);
}
.floating-btn:hover {
  transform: scale(1.08);
}
    
/* Efek denyut halus untuk tombol popup hadiah */
.pas-popup .pas-btn {
  animation: popupPulse 1.8s infinite ease-in-out;
}

@keyframes popupPulse {
  0%   { transform: scale(1); box-shadow: 0 0 0 rgba(0,0,0,0.3); }
  50%  { transform: scale(1.05); box-shadow: 0 0 12px rgba(0,0,0,0.2); }
  100% { transform: scale(1); box-shadow: 0 0 0 rgba(0,0,0,0.3); }
}
    
.btn-hide { display: none !important; }

    .marquee-box {
  display: flex;
  align-items: center;
  background: linear-gradient(165deg, #ffe27a 0%, #f1c232 40%, #d8a700 100%);
  padding: 8px 12px;
  border-radius: 12px;
  max-width: 680px;
  margin: 0 auto 14px;
  box-shadow: 0 4px 8px rgba(0,0,0,0.25), inset 0 2px 0 rgba(255,255,255,0.4);
}

.marquee-icon {
  font-size: 20px;
  font-weight: bold;
  margin-right: 8px;
  flex-shrink: 0; /* biar ikon tidak mengecil */
}

.marquee-container {
  overflow: hidden;
  flex: 1;
}

.marquee-text {
  display: inline-block;
  white-space: nowrap;
  animation: marqueeAnim 15s linear infinite;
  font-weight: bold;
}

@keyframes marqueeAnim {
  0%   { transform: translateX(100%); }
  100% { transform: translateX(-100%); }
}

/* Box terpilih: back jadi hijau + glow hijau */
.card.selected-box .back{
  background: linear-gradient(160deg, #00c853 0%, #00e676 50%, #1b5e20 100%) !important;
  color:#fff !important;
  box-shadow: 0 0 16px rgba(0,255,120,.85), 0 0 36px rgba(0,255,120,.45);
  transition: background .25s ease, box-shadow .25s ease;
}

/* Override glow kuning saat hover — jangan ganggu yang hijau */
.card.selected-box:hover{
  box-shadow: 0 0 0 rgba(0,0,0,0); /* matikan hover kuning bawaan .card */
}

/* Optional: saat sudah flipped, hover kuning dimatikan juga */
.card.flipped:hover{
  box-shadow: none;
}
    
#confetti-canvas {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  pointer-events: none; /* biar klik tetap tembus ke bawah */
  z-index: 10000; /* lebih tinggi dari popup hadiah */
}

/* getar halus */
@keyframes pasShake {
  0%, 100% { transform: translate3d(0,0,0) rotate(0deg); }
  5%  { transform: translate3d(1px,-1px,0) rotate(-0.4deg); }
  10% { transform: translate3d(-1px,1px,0) rotate(0.4deg); }
  15% { transform: translate3d(1px,0,0) rotate(-0.3deg); }
  20% { transform: translate3d(-1px,0,0) rotate(0.3deg); }
  25% { transform: translate3d(0,1px,0) rotate(-0.2deg); }
  30% { transform: translate3d(0,-1px,0) rotate(0.2deg); }
  /* sisanya diam sampai akhir biar tidak terlalu ramai */
  60%, 99% { transform: translate3d(0,0,0) rotate(0deg); }
}

/* terapkan ke semua box */
.card.shake {
  animation: pasShake 4.5s ease-in-out infinite;
  animation-delay: var(--shake-delay, 0s); /* tiap box beda delay */
  will-change: transform;
}

/* saat di-hover atau sudah dibuka, hentikan getar */
.card:hover,
.card.flipped {
  animation: none !important;
}

/* aksesibilitas: matikan kalau user pilih reduce motion */
@media (prefers-reduced-motion: reduce) {
  .card.shake { animation: none !important; }
}
    
/* LINK LOGIN: gaya sama seperti input, teks tebal & uppercase */
.login-link,
.login-link:link,
.login-link:visited{
  display:flex;
  justify-content:center;
  align-items:center;

  width:240px;
  padding:12px 14px;           /* tanpa ikon kiri */
  border-radius:14px;
  border:1px solid #b37b00;
  background:
    radial-gradient(120% 80% at 30% 0%, rgba(255,255,255,.35) 0%, rgba(255,255,255,0) 60%),
    linear-gradient(165deg,#ffe27a 0%, #f1c232 40%, #d8a700 100%);
  box-shadow:
    inset 0 2px 0 rgba(255,255,255,.45),
    inset 0 -3px 8px rgba(0,0,0,.15),
    0 6px 16px rgba(179,123,0,.18);

  color:#1a1300 !important;    /* hilangkan ungu */
  text-decoration:none !important;
  text-transform:uppercase;
  font-weight:900;
  letter-spacing:.6px;
  text-shadow:0 1px 0 rgba(255,255,255,.35);
}

.login-link:hover,
.login-link:focus{
  transform: translateY(-1px);
  border-color:#ffcf33;
  box-shadow:
    inset 0 2px 0 rgba(255,255,255,.55),
    inset 0 -3px 10px rgba(0,0,0,.18),
    0 0 0 3px rgba(255,207,51,.28),
    0 10px 22px rgba(255,215,0,.25);
  outline:0;
}
    
/* Pusatkan tombol LINK LOGIN */
.login-wrap{
  width:100%;
  display:flex;
  justify-content:center;
  margin:18px 0 28px;
}
.login-link{ margin:0 auto; } /* center */

.card.zonk-box .back{
  background: linear-gradient(160deg,#ff3b30 0%,#ff6b6b 50%,#b00020 100%) !important;
  color:#fff !important;
  box-shadow: 0 0 16px rgba(255,59,48,.85), 0 0 36px rgba(255,59,48,.45);
}
.zonk-label{
  font-family:'Russo One',sans-serif;
  font-size:22px;
  text-transform:uppercase;
  letter-spacing:.6px;
}

/* === PROMO POPUP 610x310 === */
.promo-overlay{
  position:fixed; inset:0; display:none;
  align-items:center; justify-content:center;
  background:rgba(0,0,0,.82); z-index:10080;
}
.promo-box{
  width:610px; height:310px; position:relative; overflow:hidden;
  border-radius:12px; box-shadow:0 20px 60px rgba(0,0,0,.55);
  background:#000;
}
.promo-box img{ width:100%; height:100%; object-fit:cover; display:block; }
.promo-close{
  position:absolute; top:6px; right:6px; width:32px; height:32px;
  border:none; border-radius:50%; cursor:pointer;
  background:rgba(0,0,0,.6); color:#fff; font-weight:900; line-height:32px;
}
@media (max-width:660px){
  .promo-box{ width:min(95vw,610px); height:calc(min(95vw,610px) * 310 / 610); }
}

/* Konten di dalam tetap rapi di atas background emas */
#popup .pas-popup{ margin-top:10px; }

/* Tombol X (emas solid) */
.popup-x{
  position:absolute; top:8px; right:10px;
  background:transparent !important;
  border:none; outline:none;
  color:#FFD700 !important;            /* EMAS */
  font-weight:900; font-size:24px;
  line-height:1; cursor:pointer;
  text-shadow:0 1px 2px rgba(0,0,0,.45), 0 0 8px rgba(255,215,0,.45);
  transition:transform .15s ease;
}
.popup-x:hover{ transform:scale(1.08); }

/* Override: tombol X di popup promo (tanpa background, lebih besar) */
    
.promo-close{
  position:absolute; top:6px; right:6px;
  background:transparent !important;  /* hilangkan lingkaran hitam */
  border:none !important;
  border-radius:0 !important;
  color:#fff !important;              /* X putih */
  font-size:30px !important;          /* lebih besar */
  line-height:1 !important;
  padding:6px 8px !important;         /* area klik nyaman */
  width:auto !important; height:auto !important;
  text-shadow:0 1px 2px rgba(0,0,0,.45);
  cursor:pointer; transition:transform .15s ease;
}
.promo-close:hover{ transform:scale(1.06); }

  /* ==== Popup hadiah: ABU-ABU SMOOTH + X putih ==== */
#popup .popup-box{
  position: relative;
  width: min(92%, 380px);
  padding: 22px;
  border-radius: 16px;

  /* abu-abu halus */
  background:
    radial-gradient(140% 90% at 30% 0%, rgba(255,255,255,.55) 0%, rgba(255,255,255,0) 60%),
    linear-gradient(180deg, #f5f6f8 0%, #e8eaef 100%) !important;
  border: 1px solid rgba(0,0,0,.12) !important;
  color:#111 !important;
  box-shadow:
    inset 0 1px 0 rgba(255,255,255,.6),
    inset 0 -2px 8px rgba(0,0,0,.08),
    0 12px 28px rgba(0,0,0,.28);
}

/* tombol X putih tanpa background, sedikit lebih besar */
/* Tombol X (emas) */
.popup-x{
  position:absolute; top:8px; right:10px;
  background:transparent !important;
  border:none; outline:none;
  color:#FFD700 !important;   /* EMAS */
  font-weight:900; font-size:24px;
  line-height:1; cursor:pointer;
  text-shadow:0 1px 2px rgba(0,0,0,.45), 0 0 8px rgba(255,215,0,.45);
  transition:transform .15s ease;
}
.popup-x:hover{ transform:scale(1.08); }

/* hint tetap kontras di background abu-abu */
#popup .pas-hint{
  background:#fff;
  border:1px solid rgba(0,0,0,.08);
}   

/* === Border EMAS untuk promo popup === */
.promo-box{
  position: relative;
  border-radius: 14px;
  overflow: hidden;                 /* biar sudut emas rapi */
}

/* cincin emas gradient */
.promo-box::after{
  content:"";
  position:absolute; inset:0;
  border-radius:14px;
  padding:4px;                      /* tebal border */
  background: linear-gradient(160deg,#ffe27a 0%,#f1c232 45%,#b8860b 100%);
  -webkit-mask:
    linear-gradient(#000 0 0) content-box,
    linear-gradient(#000 0 0);
  -webkit-mask-composite: xor;
          mask-composite: exclude;  /* lubangi tengahnya */
  pointer-events:none;
  z-index:2;
}

/* sedikit glow biar makin “emas” */
.promo-box{
  box-shadow: 0 12px 34px rgba(0,0,0,.45),
              0 0 22px rgba(255,215,0,.35);
}

/* Grid responsif: 3 kolom di layar lebar, 2 kolom di HP, 1 kolom di HP super kecil */
.grid{
  display:grid;
  gap:20px;
  justify-content:center;
  margin:28px auto 6px;
  grid-template-columns:repeat(3, minmax(160px, 1fr));
  max-width:640px;
}

@media (max-width:720px){
  .grid{ grid-template-columns:repeat(2, minmax(150px, 1fr)); max-width:520px; }
}
@media (max-width:380px){
  .grid{ grid-template-columns:1fr; max-width:340px; }
}

/* Kartu fleksibel, tetap kotak */
.card{ width:100%; aspect-ratio:1 / 1; perspective:1000px; }
.card-inner{ position:relative; width:100%; height:100%; transform-style:preserve-3d; transition:transform .6s ease; }
.face{ position:absolute; inset:0; border-radius:16px; overflow:hidden; box-shadow:0 0 10px rgba(255,215,0,.7); display:flex; align-items:flex-end; justify-content:center; backface-visibility:hidden; }

.input-gold,
.login-link {
  width: min(92vw, 320px);
}    

  </style>

  <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
</head>
<body>
  <h1>🎁 Dana Kaget Papanatasslot 🎁</h1>
  
<div class="marquee-box">
  <span class="marquee-icon">📢 :</span>
  <div class="marquee-container">
    <div class="marquee-text">
      Deposit Minimal 100,000 Dan Dapatkan Bonus Garansi Kekalahan 100% Di Akhir Klaim Sekarang Juga !!!
    </div>
  </div>
</div>
  
  <div class="input-container">
    <input id="userId" class="input-gold" placeholder="Masukkan USER ID">
    <input id="kupon"  class="input-gold" placeholder="Masukkan KUPON">
  </div>

  <div class="grid" id="grid">
    <!-- 6 cards -->
    <div class="card"><div class="card-inner">
      <div class="face front"><button class="btn" onclick="claim(1)">PILIH BOX</button></div>
      <div class="face back"></div>
    </div></div>
    
    <div class="card"><div class="card-inner">
      <div class="face front"><button class="btn" onclick="claim(2)">PILIH BOX</button></div>
      <div class="face back"></div>
    </div></div>

    <div class="card"><div class="card-inner">
      <div class="face front"><button class="btn" onclick="claim(3)">PILIH BOX</button></div>
      <div class="face back"></div>
    </div></div>

    <div class="card"><div class="card-inner">
      <div class="face front"><button class="btn" onclick="claim(4)">PILIH BOX</button></div>
      <div class="face back"></div>
    </div></div>

    <div class="card"><div class="card-inner">
      <div class="face front"><button class="btn" onclick="claim(5)">PILIH BOX</button></div>
      <div class="face back"></div>
    </div></div>

    <div class="card"><div class="card-inner">
      <div class="face front"><button class="btn" onclick="claim(6)">PILIH BOX</button></div>
      <div class="face back"></div>
    </div></div>
  </div>

  <div class="login-wrap">
    <a class="login-link" href="https://papanatasslotgaming2.com" target="_top">Link Login</a>
  </div>

  <!-- Popup (SATU SAJA) -->
  <div class="popup" id="popup" style="display:none; align-items:center; justify-content:center; position:fixed; inset:0; background:rgba(0,0,0,.82); z-index:999;">
  <div class="popup-box" id="popup-content"></div>
</div>

  <script>
  const GAS_URL = "https://script.google.com/macros/s/AKfycbzBrCqW_moLD7izqP_p3kCksdT_SDZ6Zq9VZoUDYEs4RD76tSGKmjLPwggR1rwjuSmT3g/exec";
  let locked = false;

  function setEnabled(enabled){
    document.querySelectorAll('.btn').forEach(b=>{
      b.disabled = !enabled;
      if(!enabled) b.textContent = "PILIH BOX";
      else b.textContent = "PILIH BOX";
    });
  }
    
function mapDisplay(v){
  if (v === 100000) return { type:'zonk' };        // ZONK !
  if (v === 250000) return { type:'num', value:25000 };
  if (v === 50000)  return { type:'num', value:2000 };
  return { type:'num', value:v };
}
    
  // === Tambahkan helper shuffle di sini ===
function shuffle(arr){
  for(let i = arr.length - 1; i > 0; i--){
    const j = Math.floor(Math.random() * (i + 1));
    [arr[i], arr[j]] = [arr[j], arr[i]];
  }
  return arr;
}

  async function claim(idx){
  if (locked) return;

  const userId = document.getElementById('userId').value.trim();
  const kupon  = document.getElementById('kupon').value.trim();
  if(!userId || !kupon){
    alert('⚠️ Masukkan USER ID dan KUPON terlebih dahulu!');
    return;
  }

  setEnabled(false);
  // feedback kecil di tombol agar terasa responsif

  try {
    const url = `${GAS_URL}?action=pilihBox&userId=${encodeURIComponent(userId)}&kupon=${encodeURIComponent(kupon)}&idx=${encodeURIComponent(idx)}`;
    const r = await fetch(url, { method: "GET", redirect: "follow", cache: "no-store" });

    // Ambil teks mentah dulu supaya kalau bukan JSON kita bisa lihat potongannya
    const txt = await r.text();
    console.log('RAW RESPONSE:', txt.slice(0, 300));

    if (!r.ok) {
      alert(`Gagal (HTTP ${r.status}). Cek pengaturan Web App GAS.`);
      setEnabled(true);
      document.querySelectorAll('.btn').forEach(b => b.textContent = 'PILIH BOX');
      return;
    }

    let res;
    try {
      res = JSON.parse(txt);
    } catch (e) {
      // Ini sering terjadi kalau Web App belum "Anyone" → balas login HTML Google
      alert("Server tidak mengirim JSON (mungkin Web App belum di-set 'Anyone').\n" +
            "Potongan balasan:\n" + txt.slice(0, 200) + "...");
      setEnabled(true);
      document.querySelectorAll('.btn').forEach(b => b.textContent = 'PILIH BOX');
      return;
    }

    if (res.status !== "success") {
      alert(res.message || "Terjadi kesalahan.");
      setEnabled(true);
      document.querySelectorAll('.btn').forEach(b => b.textContent = 'PILIH BOX');
      return;
    }

    document.querySelectorAll('.card').forEach((c, i) => {
  if (i !== (idx - 1)) {
    const btn = c.querySelector('.front .btn');
    if (btn) {
      btn.classList.add('btn-hide');  // CSS: display:none !important
      btn.style.display = 'none';     // hard fallback kalau ada override
    }
  }
});

    // === flip kartu & isi hadiah ===
const cards = document.querySelectorAll('.card');

// mulai animasi flip semua kartu
cards.forEach((c,i)=> setTimeout(()=> c.classList.add('flipped'), i*120));

// pool nominal palsu
const pool = [4000, 6000, 10000, 50000, 100000, 250000];

// pastikan tidak ada yang sama dengan hadiah asli
const hadiahAsli = Number(res.hadiah);
const others = shuffle(pool.filter(v => v !== hadiahAsli));

// siapkan 6 nilai unik untuk 6 kotak
const displayAmounts = new Array(6);
displayAmounts[idx - 1] = hadiahAsli;      // kotak yang dipilih = hadiah asli

let k = 0;
for (let i = 0; i < 6; i++) {
  if (i === (idx - 1)) continue;
  displayAmounts[i] = others[k++];          // sisanya pakai pool yang sudah dibersihkan
}

setTimeout(()=>{
  cards.forEach((c,i)=>{
    const back = c.querySelector('.back');
    const v = displayAmounts[i];

    // mapping display
    const isZonk = (v === 100000);
    let shownV = v;
    if (v === 250000) shownV = 25000;   // 250k -> 25k
    else if (v === 50000) shownV = 2000; // 50k  -> 2k

    const labelRp = `Rp ${shownV.toLocaleString('id-ID')}`;

    if (isZonk) {
      // ZONK: merah + teks putih
      c.classList.add('zonk-box');
      back.innerHTML = `<div class="zonk-label">ZONK !</div>`;
    } else if (i === (idx - 1)) {
      // kartu terpilih (hijau)
      c.classList.add('selected-box');
      back.innerHTML = `
        <div class="saldo-wrap">
          <div class="saldo-title">SALDO AKUN</div>
          <div class="saldo-amount">${labelRp}</div>
        </div>`;
    } else {
      // kartu lain biasa
      back.innerHTML = `<div class="fake-amount">${labelRp}</div>`;
    }
  });
}, 260);

    setTimeout(()=>{
  document.getElementById('popup-content').innerHTML = `
  <button class="popup-x" aria-label="Tutup"
    onclick="document.getElementById('popup').style.display='none'">✖</button>
  <div class="pas-popup">
    <img class="pas-brand" src="https://i.ibb.co/VWz6Nfz8/papanatasslot-logo.png" alt="Papan Atas Slot">
    <div class="pas-subtitle">Anda mendapatkan</div>
    <div class="pas-amount">IDR ${Number(res.hadiah).toLocaleString('id-ID')}</div>
    <div class="pas-meta">Coupon Code : <b>${res.kupon}</b></div>
    <div class="pas-meta">Username : <b>${(res.username || res.userId || '-')}</b></div>
    <div class="pas-hint">SCREENSHOT DAN KLAIM HADIAH MELALUI WHATSAPP ATAU TELEGRAM</div>
    <div class="pas-btn-row">
      <a href="https://klikblg.com/wa-pas"   target="_blank" rel="noopener" class="pas-btn pas-wa">KLAIM WA</a>
      <a href="https://klikblg.com/tele-pas" target="_blank" rel="noopener" class="pas-btn pas-tg">KLAIM TELE</a>
    </div>
    <button type="button" class="pas-btn pas-reset"
      onclick="document.getElementById('popup').style.display='none'; resetBoxes();">
      PILIH BOX LAGI
    </button>
  </div>
`;
  document.getElementById('popup').style.display = 'flex';

   // Jalankan confetti di canvas khusus (di depan popup)
requestAnimationFrame(() => {
  const myCanvas = document.getElementById('confetti-canvas');
  const myConfetti = confetti.create(myCanvas, { resize: true, useWorker: true });
  myConfetti({ particleCount: 160, spread: 70, origin: { y: 0.6 } });
});
      
  locked = true;
  document.querySelectorAll('.btn').forEach(b => b.textContent = 'PILIH BOX');
}, cards.length*120 + 360 + 3000); // +3 detik

  } catch (err) {
    console.error(err);
    alert("Gagal menghubungi server. Coba lagi.");
    setEnabled(true);
    document.querySelectorAll('.btn').forEach(b => b.textContent = 'PILIH BOX');
  }
}

 function resetBoxes(){
  const cards = document.querySelectorAll('.card');

  cards.forEach(card => {
    card.classList.remove('flipped', 'selected-box', 'zonk-box');
    card.style.boxShadow = '';                         // bersihkan glow inline kalau ada
    const back = card.querySelector('.back');
    if (back){
      back.innerHTML = '';
      back.style.cssText = '';                         // bersihkan inline style di back
      showPromo();   // tampilkan popup promo lagi setelah reset
    }
  });

  // balikin tombol
  document.querySelectorAll('.btn.btn-hide').forEach(b => b.classList.remove('btn-hide'));
  document.querySelectorAll('.front .btn').forEach(b => b.style.removeProperty('display'));

  // tutup popup & reset state
  document.getElementById('popup').style.display = 'none';
  locked = false;
  setEnabled(true);
  document.getElementById('userId').value = '';
  document.getElementById('kupon').value  = '';

    // tampilkan promo SEKALI (bukan 6x)
  showPromo();
}

// aktifkan getar random untuk semua kartu saat halaman buka
document.querySelectorAll('.card').forEach((c) => {
  c.classList.add('shake');
  c.style.setProperty('--shake-delay', (Math.random() * 2.5).toFixed(2) + 's');
});
    
</script>

  <!-- Tombol Mengambang Telegram & WhatsApp -->
<a href="https://klikblg.com/tele-pas" target="_blank" class="floating-btn" style="bottom: 180px;">
  <img src="https://i.ibb.co/tMf82kDb/telegram-gif.gif" alt="Telegram" />
</a>

<a href="https://klikblg.com/wa-pas" target="_blank" class="floating-btn" style="bottom: 110px;">
  <img src="https://i.ibb.co/LXp1Yy3S/whats-app.gif" alt="WhatsApp" />
</a>

<!--Start of Tawk.to Script-->
  <script type="text/javascript">
  var Tawk_API=Tawk_API||{}, Tawk_LoadStart=new Date();
  (function(){
  var s1=document.createElement("script"),s0=document.getElementsByTagName("script")[0];
  s1.async=true;
  s1.src='https://embed.tawk.to/680c7b424b378d190bfa1983/1ipoc2vkj';
  s1.charset='UTF-8';
  s1.setAttribute('crossorigin','*');
  s0.parentNode.insertBefore(s1,s0);
  })();
    
  </script>
  <!--End of Tawk.to Script-->

  <script>
function haptic(ms=8){ try{ if(navigator.vibrate) navigator.vibrate(ms); }catch{} }
document.querySelectorAll('.btn').forEach(b=>{
  b.addEventListener('click', ()=> haptic(10));
});
</script>

  <script>
let cool = false;
function coolDown(ms=1200){
  cool = true; setTimeout(()=> cool = false, ms);
}
    
const _claimOrig = claim; // simpan referensi aslinya
window.claim = async function(idx){
  if (cool) return;
  coolDown();
  await _claimOrig(idx);
}
</script>

  <script>
let lastClickedBtn = null;
// tandai tombol yang ditekan
document.querySelectorAll('.grid .front .btn').forEach(btn=>{
  btn.addEventListener('click', function(){
    lastClickedBtn = this;
    this.dataset.prev = this.textContent;
    this.textContent = 'Mengecek...';
  });
});

// wrap claim versi cooldown (yang sudah ada) supaya tombol balik normal
const _claimWithCool = window.claim;
window.claim = async function(idx){
  try { await _claimWithCool(idx); }
  finally {
    if (lastClickedBtn) {
      lastClickedBtn.textContent = lastClickedBtn.dataset.prev || 'PILIH BOX';
      lastClickedBtn = null;
    }
  }
}
</script>

  <canvas id="confetti-canvas"></canvas>

  <!-- Promo Popup -->
<div id="promoPopup" class="promo-overlay" aria-modal="true" role="dialog">
  <div class="promo-box">
    <button class="promo-close" aria-label="Tutup" onclick="hidePromo()">✖</button>
    <a href="https://papanatasslotgaming2.com" target="_top" rel="noopener">
      <img src="https://i.ibb.co/GQNJ9VSM/20250706004135-banner-papanatasslot-popup-all-promo.jpg" alt="Promo - Event - Bonus">
    </a>
  </div>
</div>

  <script>
function showPromo(){ document.getElementById('promoPopup').style.display='flex'; }
function hidePromo(){ document.getElementById('promoPopup').style.display='none'; }

// Muncul saat pertama kali buka / refresh
document.addEventListener('DOMContentLoaded', showPromo);

// Tutup dengan ESC
document.addEventListener('keydown', e=>{
  const el = document.getElementById('promoPopup');
  if (e.key === 'Escape' && el.style.display === 'flex') hidePromo();
});
</script>
  
</body>
</html>
